import{r as c,at as o,j as t,aH as P,F as U,u as B}from"./iframe-DRCDqYKx.js";import{I as K}from"./constants-CZYEPhht.js";import{F as X}from"./FilterBar.component-BvxYuhsl.js";import{g as f}from"./theme-CzxyoK-X.js";import{f as z}from"./flow-Dpm74b83.js";import{R as j}from"./RichLayout.component-CffTlO9W.js";import{A as Y}from"./ActionButton.component-1Icy61zR.js";function G(e,s){return!Number.isInteger(e.order)&&!Number.isInteger(s.order)?0:Number.isInteger(e.order)&&!Number.isInteger(s.order)?-1:!Number.isInteger(e.order)&&Number.isInteger(s.order)?1:e.order-s.order}const W=e=>(e.sort(G).forEach((s,r)=>{s.order=r+1}),e),J=e=>({visible:!e.hidden,label:e.label,order:e.order,key:e.key,locked:!!e.locked}),Q=(e,s)=>r=>s<e?{...r,locked:!0}:r,Z=e=>e.visible===void 0?{...e,visible:!1}:e,ee=(e,s)=>{const r=e.map((l,n)=>z([J,Z,Q(s,n)])(l));return W(r)},E=(e,s)=>e.locked?e:{...e,visible:s},oe=(e=[],s=0,r="")=>{const[l,n]=c.useState(()=>ee(e,s)),[i,m]=c.useState(r),h=c.useMemo(()=>l.filter(a=>a.label.toLowerCase().includes(i.toLowerCase())),[l,i]),x=(a,u)=>{const d=l.map(C=>C.label!==u?C:E(C,a));n(d)},_=a=>{const u=l.map(d=>h.some(C=>C.label===d.label)?E(d,a):d);n(u)},y=c.useMemo(()=>{let a=!1,u=h.filter(d=>!d.locked);if(u.length){const d=u.filter(C=>C.visible);a=d.length===u.length||(d.length?void 0:!1)}return a},[h]);return{onChangeVisibility:x,onSelectAll:_,columns:l,filteredColumns:h,selectAll:y,textFilter:i,setTextFilter:m}},F=c.createContext(),T=()=>{const e=c.useContext(F);if(!e)throw new Error("[columnChooserContext]: you are using some column chooser components outside the column chooser context");return e},se=F.Provider,p={"tc-column-chooser":"_tc-column-chooser_aomei_2","tc-column-chooser-header":"_tc-column-chooser-header_aomei_8","tc-column-chooser-header-title":"_tc-column-chooser-header-title_aomei_12","tc-column-chooser-filter":"_tc-column-chooser-filter_aomei_15","tc-column-chooser-body":"_tc-column-chooser-body_aomei_18","tc-column-chooser-columns-list":"_tc-column-chooser-columns-list_aomei_23","tc-column-chooser-footer":"_tc-column-chooser-footer_aomei_5","tc-column-chooser-row":"_tc-column-chooser-row_aomei_31","tc-column-chooser-row-select-all":"_tc-column-chooser-row-select-all_aomei_37","tc-column-chooser-row-label":"_tc-column-chooser-row-label_aomei_44"},te=f(p),S=({label:e})=>t.jsx("span",{className:te("tc-column-chooser-row-label"),children:e});S.propTypes={label:o.string.isRequired};const v=({dataFeature:e,description:s,id:r,label:l,locked:n=!1,onChange:i,checked:m=!1,intermediate:h=!1})=>{const x=y=>{const a=h?!0:y.target.checked;i(a,l)},_=`${r}-${s}`;return n?t.jsxs(c.Fragment,{children:[t.jsx(P,{name:"locker-closed",size:"M"}),t.jsx(S,{label:l})]}):t.jsxs(c.Fragment,{children:[t.jsx(U.Checkbox,{checked:m,"data-feature":e,"aria-describedby":_,id:`${r}-checkbox-${l.replace(/\s+/g,"-")}`,label:l,onChange:x,indeterminate:h}),t.jsx("div",{id:_,className:"sr-only",children:s})]})};v.propTypes={dataFeature:o.string.isRequired,description:o.string.isRequired,id:o.string.isRequired,label:o.string.isRequired,locked:o.bool,onChange:o.func.isRequired,checked:o.bool,intermediate:o.bool};const re=f(p),b=({children:e,className:s})=>t.jsx("div",{className:re("tc-column-chooser-row",s),children:e});b.propTypes={children:o.oneOfType([o.element,o.arrayOf(o.element)]),className:o.string};b.Checkbox=v;b.Label=S;const le=f(p),ne=(e,s)=>e?{label:s("TC_COLUMN_CHOOSER_UNSELECT_ALL","Unselect all"),description:s("CHECKBOX_DESELECT_ALL_COLUMNS_DESCRIPTION","hide all the columns")}:{label:s("TC_COLUMN_CHOOSER_SELECT_ALL","Select all"),description:s("CHECKBOX_SELECT_ALL_COLUMNS_DESCRIPTION","display all the columns")},A=({id:e,onChange:s,value:r,t:l})=>{const{label:n,description:i}=ne(r,l);return t.jsx(b,{className:le("tc-column-chooser-row-select-all"),children:t.jsx(b.Checkbox,{id:e,dataFeature:"column-chooser.select.all",description:i,label:n,onChange:s,checked:r,intermediate:r===void 0,t:l})})};A.propTypes={id:o.string.isRequired,onChange:o.func.isRequired,value:o.bool,t:o.func.isRequired};const ce=o.shape({label:o.string.isRequired,locked:o.bool,order:o.number,visible:o.bool}),ie=o.arrayOf(ce),I=({columns:e=[],id:s,onChangeCheckbox:r,t:l})=>e.map(n=>t.jsx(b,{children:t.jsx(b.Checkbox,{checked:n.visible,id:s,dataFeature:"column-chooser.select",description:l("CHECKBOX_DISPLAY_COLUMN_DESCRIPTION",{defaultValue:"display the column {{label}}",label:n.label}),label:n.label,locked:n.locked,onChange:r,t:l})},n.key));I.propTypes={columns:ie,id:o.string.isRequired,onChangeCheckbox:o.func.isRequired,t:o.func.isRequired};const w=f(p),ae=()=>{const{columns:e,id:s,onChangeVisibility:r,onSelectAll:l,selectAll:n,t:i}=T(),m=`${s}-body`;return t.jsxs(c.Fragment,{children:[t.jsx(A,{id:m,onChange:l,value:n,t:i}),t.jsx("div",{className:w("tc-column-chooser-columns-list"),children:t.jsx(I,{id:m,columns:e,onChangeCheckbox:r,t:i})})]})},N=({children:e=t.jsx(ae,{})})=>{const{columns:s}=T();return typeof e=="function"?e(s):t.jsx(j.Body,{id:"column-chooser-body",children:t.jsx("div",{className:w("tc-column-chooser-body"),children:e})})};N.propTypes={children:o.func};N.Row=b;const ue=f(p),M=()=>{const{id:e,t:s}=T();return t.jsx(Y,{bsStyle:"info",id:`${e}-submit-button`,label:s("COLUMN_CHOOSER_APPLY_BUTTON",{defaultValue:"Apply"}),type:"submit","data-feature":"column-chooser.submit"})},L=({children:e=t.jsx(M,{}),className:s})=>t.jsx(j.Footer,{id:"column-chooser-footer",className:ue("tc-column-chooser-footer"),children:e});L.Submit=M;L.propTypes={children:o.oneOfType([o.element,o.arrayOf(o.element)]),className:o.string};const q=f(p),de=e=>e.visible,me=()=>{const{columns:e,t:s}=T(),r=s("SELECT_COLUMNS",{count:e.filter(de).length,total:e.length,defaultValue:"{{count}}/{{total}} selected"});return t.jsxs("div",{children:[t.jsx("div",{className:q("tc-column-chooser-header-title"),children:s("COLUMN_CHOOSER_HEADER_TITLE",{defaultValue:"Select columns to display"})}),t.jsx("div",{id:"selected-columns-text",children:r})]})},g=({className:e,children:s=t.jsx(me,{})})=>t.jsx(j.Header,{id:"column-chooser-header",className:q("tc-column-chooser-header",e),children:s});g.propTypes={children:o.oneOfType([o.element,o.arrayOf(o.oneOfType([o.element]))]),className:o.string};g.SelectAll=g;const R=f(p),he=e=>({hidden:!e.visible,label:e.label,order:e.order,key:e.key}),Ce=e=>e.map(he);function O({children:e,id:s,columnsFromList:r,initialFilterValue:l,nbLockedLeftItems:n=0,onSubmit:i}){const{t:m}=B(K),{columns:h,filteredColumns:x,onChangeVisibility:_,onSelectAll:y,selectAll:a,setTextFilter:u,textFilter:d}=oe(r,n,l);c.useEffect(()=>{console.warn("Guideline and development of the ColumnChooser component still in progress. It may have breaking change in the future")},[]);const C=k=>{k.preventDefault(),i(k,Ce(h))},V=c.useCallback((k,D)=>u(D),[u]),$=c.useCallback(()=>u(""),[u]),H=t.jsxs(c.Fragment,{children:[t.jsx(g,{}),t.jsx(X,{autoFocus:!1,className:R("tc-column-chooser-filter"),dockable:!1,docked:!1,iconAlwaysVisible:!0,id:`${s}-filter`,placeholder:m("FIND_COLUMN_FILTER_PLACEHOLDER",{defaultValue:"Find a column"}),onToggle:$,onFilter:V,value:d}),t.jsxs("form",{id:`${s}-form`,className:R("tc-column-chooser"),onSubmit:C,children:[t.jsx(N,{}),t.jsx(L,{})]})]});return t.jsx(se,{value:{columns:x,id:s,onChangeVisibility:_,onSelectAll:y,selectAll:a,t:m},children:e||H})}O.Header=g;O.Body=N;O.Footer=L;O.propTypes={children:o.oneOfType([o.element,o.arrayOf(o.element)]),columnsFromList:o.array.isRequired,id:o.string.isRequired,initialFilterValue:o.string,nbLockedLeftItems:o.number,onSubmit:o.func.isRequired};export{O as C};

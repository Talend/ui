import{r as p,j as i,at as t,F as k,c as S,aH as B}from"./iframe-BPWKJ2_o.js";import{u as G}from"./usePopper-CM0sjsC9.js";import{o as j}from"./omit-Dp4FCWoh.js";import{f as L}from"./index-BPavWh-U.js";import{F as U}from"./FocusManager.component-rpkdNNjL.js";import{a as V}from"./translate-q8yQChef.js";import{i as W}from"./isWithinInterval-CUy1UPDd.js";import{e as N,a as b,b as v,c as y}from"./Picker.component-KrzNXMR-.js";import{g as z,I as $,u as H}from"./useInputPickerHandlers-B0Zm3pt6.js";import{D as J}from"./index-CPccb1WS.js";const E=p.createContext();function Q(e,o){this.message=z(o),this.code=e}function O(e,o,d){const n=N(e,d),s=N(o,d);return{startDate:{value:n.localDate,textInput:n.textInput},endDate:{value:s.localDate,textInput:s.textInput},errors:n.errors.concat(s.errors),errorMessage:n.errorMessage||s.errorMessage}}function P(e){const o={dateFormat:e.dateFormat},d=O(e.startDate,e.endDate,o),[n,s]=p.useState(d);p.useEffect(()=>{if(e.startDate!==n.startDate.value||e.endDate!==n.endDate.value){const c=O(e.startDate,e.endDate,o);s(c)}},[e.startDate,e.endDate]);function u(c,a){const l=[...a.errors||[]],g=a.startDate.value,D=a.endDate.value;if(g&&D&&(W(g,D)||l.push(new Q("INVALID_RANGE_START_AFTER_END","INVALID_RANGE_START_AFTER_END"))),e.onChange){const f={startDate:g,endDate:D,errors:l,errorMessage:l[0]?l[0].message:null,origin:a.origin};e.onChange(c,f)}}function h(c,{date:a}){const{date:l,textInput:g,errors:D,errorMessage:f}=b(a,o),r={};r.startDate={value:l,textInput:g},r.errors=D,r.errorMessage=f,s(m=>({...m,...r})),u(c,{...n,...r,origin:"START_PICKER"})}function C(c,{date:a}){const{date:l,textInput:g,errors:D,errorMessage:f}=b(a,o),r={};r.endDate={value:l,textInput:g},r.errors=D,r.errorMessage=f,s(m=>({...m,...r})),u(c,{...n,...r,origin:"END_PICKER"})}function I(c){const a=c.target.value,{localDate:l,textInput:g,errors:D,errorMessage:f}=v(a,o),r={startDate:{value:l,textInput:g},errors:D,errorMessage:f};s(m=>({...m,...r})),u(c,{...n,...r,origin:"START_INPUT"})}function x(c){const a=c.target.value,{localDate:l,textInput:g,errors:D,errorMessage:f}=v(a,o),r={endDate:{value:l,textInput:g},errors:D,errorMessage:f};s(m=>({...m,...r})),u(c,{...n,...r,origin:"END_INPUT"})}return i.jsx(E.Provider,{value:{startDate:n.startDate,endDate:n.endDate,inputManagement:{onStartChange:I,onEndChange:x,placeholder:e.dateFormat},pickerManagement:{onStartChange:h,onEndChange:C}},children:e.children})}P.defaultProps={dateFormat:"YYYY-MM-DD"};P.displayName="DateRange.Manager";P.propTypes={children:t.element,startDate:t.oneOfType([t.instanceOf(Date),t.number,t.string]),endDate:t.oneOfType([t.instanceOf(Date),t.number,t.string]),dateFormat:t.string,onChange:t.func.isRequired};const X=["date","onChange","onFocus","label","minWidth"],F=p.forwardRef((e,o)=>{const{date:d,onChange:n,onFocus:s,label:u,minWidth:h}=e,{inputManagement:C}=p.useContext(E),{placeholder:I}=C;return i.jsxs("div",{className:"range-input",children:[u&&i.jsx(k.Label,{htmlFor:e.id,children:u}),i.jsx($,{inputText:I,minWidth:h,children:x=>i.jsx(J,{autoComplete:"off",debounceTimeout:300,element:k.Text,hideLabel:!0,placeholder:I,value:d.textInput,style:{width:x},onChange:n,onFocus:s,inputRef:o,...j(e,X)})})]})});F.displayName="DateRange.Input";F.propTypes={id:t.string.isRequired,date:t.shape({textInput:t.string}),onChange:t.func,onFocus:t.func,label:t.string,minWidth:t.number};const Z="startDate",ee="endDate";function A(e){const{startDate:o,endDate:d,pickerManagement:n}=p.useContext(E),{onStartChange:s,onEndChange:u}=n;return[e.focusedInput===Z&&i.jsx(y,{manageFocus:!0,selectedDate:o.value,endDate:d.value,onSubmit:s,...e},"CalendarPicker_StartDate"),e.focusedInput===ee&&i.jsx(y,{manageFocus:!0,selectedDate:d.value,startDate:o.value,onSubmit:u,...e},"CalendarPicker_EndDate")].filter(Boolean)}A.displayName="DateRange.Picker";const _={Manager:P,Input:F,Picker:A},te="_popper_12q0n_1",ne="_arrow_12q0n_17",T={popper:te,"date-picker":"_date-picker_12q0n_8",arrow:ne,"date-range-picker-inline":"_date-range-picker-inline_12q0n_23"},ae=["id","dateFormat","onBlur","onChange","t","isDisabledChecker"];function M(e){const o=`date-range-picker-${e.id}`,d=p.useRef(null),n=p.useRef(null),s=p.useRef(null),[u,h]=p.useState(null),[C,I]=p.useState(null),{styles:x,attributes:c}=G(u,C,{modifiers:[{name:"hide",enabled:!1},{name:"preventOverflow",enabled:!1}],strategy:"fixed",placement:"bottom-start"}),a=H({handleBlur:e.onBlur,handleChange:e.onChange,handleKeyDown:()=>L(s.current)}),l=j(e,ae);function g(){return u===d.current?"startDate":u===n.current?"endDate":null}function D(m,R){R.origin==="START_PICKER"&&n&&n.current.focus(),a.onChange(m,R,u)}const f=!!e.inline,r=S("date-picker",T["date-picker"],{"date-range-picker-inline":f,[T["date-range-picker-inline"]]:f});return i.jsx(_.Manager,{startDate:e.startDate,endDate:e.endDate,dateFormat:e.dateFormat,onChange:D,children:i.jsx(E.Consumer,{children:({inputManagement:m,startDate:R,endDate:w})=>{const{onStartChange:K,onEndChange:Y}=m;return i.jsxs(U,{className:r,divRef:s,onClick:a.onClick,onFocusIn:a.onFocus,onFocusOut:a.onBlur,onKeyDown:q=>{a.onKeyDown(q,u)},children:[i.jsx(_.Input,{...l,id:`${e.id}-start-input`,date:R,onChange:K,onFocus:()=>h(d.current),label:e.t("TC_DATE_PICKER_RANGE_FROM",{defaultValue:"From"}),ref:d}),i.jsx("span",{className:S(T.arrow,"arrow"),children:i.jsx(B,{name:"arrow-right",size:"S"})}),i.jsx(_.Input,{...l,id:`${e.id}-end-input`,date:w,onChange:Y,onFocus:()=>h(n.current),label:e.t("TC_DATE_PICKER__RANGE_TO",{defaultValue:"To"}),ref:n}),a.showPicker&&i.jsx("div",{id:o,className:T.popper,ref:I,style:x.popper,...c.popper,children:i.jsx(_.Picker,{...e,focusedInput:g()})})]})}})})}M.displayName="InputDateRangePicker";M.defaultProps={dateFormat:"YYYY-MM-DD",t:V()};M.propTypes={id:t.string.isRequired,dateFormat:t.string,onChange:t.func,onBlur:t.func,startDate:t.oneOfType([t.instanceOf(Date),t.number,t.string]),endDate:t.oneOfType([t.instanceOf(Date),t.number,t.string]),inline:t.bool,t:t.func};export{M as I};

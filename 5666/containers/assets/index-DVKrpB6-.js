import{a7 as tt,a8 as B,a9 as et,aa as it,ab as nt,ac as ot,ad as st,$ as j,b as y,J as rt,e as L,ae as w,j as K,af as at,x as I,f as G,u as lt,P as u,ag as ct,ah as b,h as A,p as k}from"./iframe-DKed6As0.js";import{r as ut,o as E}from"./omit-CWAzxCTA.js";import{g as D}from"./actionAPI-sTybn08x.js";var O,M;function ft(){if(M)return O;M=1;var t=tt(),i=B(),o=et(),n=it(),r=nt();function c(f,g,h,S){if(!n(f))return f;g=i(g,f);for(var m=-1,e=g.length,T=e-1,l=f;l!=null&&++m<e;){var a=r(g[m]),s=h;if(a==="__proto__"||a==="constructor"||a==="prototype")return f;if(m!=T){var d=l[a];s=S?S(d,a,l):void 0,s===void 0&&(s=n(d)?d:o(g[m+1])?[]:{})}t(l,a,s),l=l[a]}return f}return O=c,O}var v,q;function dt(){if(q)return v;q=1;var t=ot(),i=ft(),o=B();function n(r,c,f){for(var g=-1,h=c.length,S={};++g<h;){var m=c[g],e=t(r,m);f(e,m)&&i(S,o(m,r),e)}return S}return v=n,v}var x,H;function gt(){if(H)return x;H=1;var t=dt(),i=st();function o(n,r){return t(n,r,function(c,f){return i(n,f)})}return x=o,x}var F,N;function mt(){if(N)return F;N=1;var t=gt(),i=ut(),o=i(function(n,r){return n==null?{}:t(n,r)});return F=o,F}var yt=mt();const It=j(yt),p={LIST_TOGGLE_FILTER:"LIST_TOGGLE_FILTER",LIST_FILTER_CHANGE:"LIST_FILTER_CHANGE",LIST_CHANGE_SORT_ORDER:"LIST_CHANGE_SORT_ORDER"},pt=Object.freeze(Object.defineProperty({__proto__:null,default:p},Symbol.toStringTag,{value:"Module"}));function ht(t,i){if(!i.columnData)return{};const o=G.expression.mapStateToProps(t,i.columnData,{props:i});return Object.keys(o).length?{columnData:{...G.expression.mergeProps(i.columnData),...o}}:{}}const St=L({mapStateToProps:ht,omitCMFProps:!0,withComponentRegistry:!0,withDispatch:!0,withDispatchActionCreator:!0,withComponentId:!0})(w.cellDictionary.title.cellRenderer),bt={title:{...w.cellDictionary.title,cellRenderer:t=>K.jsx(St,{...t})}},z=new y.Map({displayMode:"table",selectedItems:new y.List,searchQuery:"",itemsPerPage:10,startIndex:1,totalResults:0,sortOn:"name",sortAsc:!0,filterDocked:!0});function Ct(t,i){return i.items.toJS().map(o=>{const n=I(i,"actions.items",[]);let r=[];return Array.isArray(n)&&n.every(c=>Array.isArray(c))?r=n.map(c=>D(t,c,o)):r=D(t,n,o),{...o,actions:r,persistentActions:D(t,I(i,"actions.persistentItemsActions",[]),o)}})}function P(t){const i=rt(),o=t.state.toJS();function n(l,a){t.setState({startIndex:l,itemsPerPage:a})}function r(l,a){t.setState({displayMode:a})}function c(){return t.state.get("selectedItems",new y.List)}function f(l,a){const s=c(),d=s.indexOf(a[t.idKey]);d>-1?t.setState({selectedItems:s.splice(d,1)}):t.setState({selectedItems:s.push(a[t.idKey])})}function g(){const l=c(),a=t.items;l.size!==a.size?t.setState({selectedItems:a.map(s=>s.get(t.idKey))}):t.setState({selectedItems:new y.List([])})}function h(l){return(a,s)=>{t.dispatchActionCreator(l,a,s,i)}}function S(l){return c().some(s=>s===l[t.idKey])}const m=Ct(i,t),e={...E(t,L.INJECTED_PROPS)};e.displayMode||(e.displayMode=o.displayMode),e.list||(e.list={}),e.list.id||(e.list.id="list"),e.list.items=m,e.list.columns||(e.list.columns=[]),e.list.sort={field:o.sortOn,isDescending:!o.sortAsc,onChange:(l,a)=>{t.dispatch({type:p.LIST_CHANGE_SORT_ORDER,payload:a,collectionId:t.collectionId,event:l})}},e.list.itemProps||(e.list.itemProps={}),e.rowHeight&&(e.rowHeight=e.rowHeight[e.displayMode]),e.list.titleProps&&e.actions.title&&(e.actions.title&&(e.list.titleProps.onClick=h(e.actions.title)),e.actions.editSubmit&&(e.list.titleProps.onEditSubmit=h(e.actions.editSubmit)),e.actions.editCancel&&(e.list.titleProps.onEditCancel=h(e.actions.editCancel)));const T={...bt};if(e.cellDictionary&&Object.keys(e.cellDictionary).reduce((l,a)=>{const s=e.cellDictionary[a];return l[a]={...E(s,["component"]),cellRenderer:t.getComponent(s.component)},l},T),e.list.cellDictionary=T,e.headerDictionary&&(e.list.headerDictionary=Object.keys(e.headerDictionary).reduce((l,a)=>{const s=e.headerDictionary[a];return l[a]={...E(s,["component"]),headerRenderer:t.getComponent(s.component)},l},{})),e.toolbar){e.toolbar.display&&(e.toolbar.display={...e.toolbar.display,onChange:(s,d)=>{r(s,d)}}),e.toolbar.sort&&(e.toolbar.sort.isDescending=!o.sortAsc,e.toolbar.sort.field=o.sortOn,e.toolbar.sort.onChange=(s,d)=>{t.dispatch({type:p.LIST_CHANGE_SORT_ORDER,payload:d,collectionId:t.collectionId,event:s})}),e.toolbar.filter&&(e.toolbar.filter.onToggle=(s,d)=>{t.dispatch({type:p.LIST_TOGGLE_FILTER,payload:{...d,filterDocked:o.filterDocked,searchQuery:o.searchQuery},collectionId:t.collectionId,event:s})},e.toolbar.filter.onFilter=(s,d)=>{t.dispatch({type:p.LIST_FILTER_CHANGE,payload:d,collectionId:t.collectionId,event:s})},e.toolbar.filter.docked=o.filterDocked,e.toolbar.filter.value=o.searchQuery),e.toolbar.actionBar={actions:{},multiSelectActions:{}},e.multiSelectActions&&t.idKey&&(e.list.itemProps.onToggle=f,e.list.itemProps.onToggleAll=g,e.list.itemProps.isSelected=S,e.toolbar.actionBar.selected=c().size);const l=e.actions,a=e.multiSelectActions;if(a&&(a.left&&(e.toolbar.actionBar.multiSelectActions.left=a.left.map(s=>({actionId:s}))),a.right&&(e.toolbar.actionBar.multiSelectActions.right=a.right.map(s=>({actionId:s})))),l&&(l.left&&(e.toolbar.actionBar.actions.left=l.left.map(s=>({actionId:s}))),l.right&&(e.toolbar.actionBar.actions.right=l.right.map(s=>({actionId:s})))),e.toolbar.pagination){const s=e.toolbar.pagination;if(Object.assign(e.toolbar.pagination,{...It(o,["totalResults","itemsPerPage","startIndex"])}),!s.onChange)s.onChange=(d,R)=>{n(d,R)};else if(typeof s.onChange=="string"){const d=s.onChange;s.onChange=(R,Z)=>{t.dispatchActionCreator(d,null,{startIndex:R,itemsPerPage:Z},i)}}}}return K.jsx(at,{...e})}P.displayName="Container(List)";P.propTypes={actions:u.shape({title:u.string,left:u.arrayOf(u.string),right:u.arrayOf(u.string)}),multiSelectActions:u.shape({title:u.string,left:u.arrayOf(u.string),right:u.arrayOf(u.string)}),idKey:u.string,list:u.shape({columns:u.array,titleProps:u.object}),toolbar:u.shape({sort:u.object,filter:u.object,pagination:u.shape({onChange:u.func})}),cellDictionary:u.object,displayMode:u.string,items:lt.list.isRequired,state:L.propTypes.state,...L.propTypes};P.defaultProps={state:z};var _t=ct();const Lt=j(_t);function Tt(t,i,o){let n=t;return y.Map.isMap(t)&&(n=t.toJS()),o.some(r=>typeof n[r.key]=="string"&&n[r.key].toLowerCase().indexOf(i.toLowerCase())!==-1)}function Q(t,i){return t.cmf.collections.get(i)}function J(t,i){const o=Q(t,i);return y.Map.isMap(o)?o.get("items"):o}function $(t,{collectionId:i}){const o=Q(t,i);return y.Map.isMap(o)?o.get("pagination"):null}function C(t){return i=>i.cmf.components.getIn(["Container(List)",t||"default"])}function U(t){const i=t,o=b(C(i.collectionId),n=>{let r=i.items;if(n){const c=n.get("searchQuery");c&&r&&(r=r.filter(f=>Tt(f,c,i.columns)))}return r});return b([o,C],n=>n)}function V(t){return(i,o)=>{let n=i.get(t),r=o.get(t);return typeof n=="string"&&typeof r=="string"?(n=n.toLowerCase(),r=r.toLowerCase(),n.localeCompare(r)):typeof n=="number"&&typeof r=="number"?n<r?-1:n>r?1:0:o[t]?-1:0}}function W(t,i,o){if(!y.List.isList(o))return new y.List;let n=o;if(!Lt(t)){const r=t.get("sortOn"),c=t.get("sortAsc"),f=I(i,"columns",[]).find(g=>g.key===r);I(f,"sortFunction")?n=n.sort(G.registry.getFromRegistry(f.sortFunction)(r,c)):n=n.sort(V(r)),c||(n=n.reverse())}return n}function X(t,i){const o=b(C(t.collectionId),n=>W(n,t,i));return b([o,C],n=>n)}function Y(t,i){const o=b(C(t.collectionId),n=>{let r=i;if(n){const c=n.get("startIndex"),f=n.get("itemsPerPage");f>0&&c>0&&(r=r.slice(c-1,Math.min(c+f-1,r.size)))}return r});return b([o,C],n=>n)}const Pt=Object.freeze(Object.defineProperty({__proto__:null,compare:V,configureGetFilteredItems:U,configureGetPagedItems:Y,configureGetPagination:$,configureGetSortedItems:X,getCollectionItems:J,getSortedResults:W},Symbol.toStringTag,{value:"Module"}));function Rt(t){return t.collectionId}function At(t,i){let o=i.items;return i.defaultFiltering!==!1&&(o=U(i)(t)),i.defaultSorting!==!1&&(o=X(i,o)(t)),o}function Et(t,i,o){return i.defaultPaging!==!1?Y(i,o)(t):o}function Dt(t,i,o){const n={},r=J(t,i.collectionId),c={collectionId:i.collectionId,items:r||i.items||i.listItems,defaultFiltering:I(i,["toolbar","filter","defaultFiltering"]),defaultSorting:I(i,["toolbar","sort","defaultSorting"]),defaultPaging:I(i,["toolbar","pagination","defaultPaging"])};i.list&&(c.columns=i.list.columns),n.items=At(t,c);const f=n.items.size;I(i,["toolbar","pagination"])&&(n.items=Et(t,c,n.items));const g=I(o,"state");return g&&(n.state=g.setIn(["totalResults"],f),n.state.has("toolbar")&&(n.state=n.state.mergeIn(["toolbar","pagination"],$(t,c)))),n}const _=L({defaultState:z,defaultProps:{saga:"List#root",listItems:new y.List},componentId:Rt,mapStateToProps:Dt,omitCMFProps:!0,withComponentRegistry:!0,withDispatch:!0,withDispatchActionCreator:!0,withComponentId:!0})(P);function*Ot(t){yield k(_.setStateAction({searchQuery:t.payload.query},t.collectionId||"default"))}function*vt(t){yield k(_.setStateAction({filterDocked:!t.payload.filterDocked},t.collectionId||"default"))}function*xt(t){yield k(_.setStateAction({sortOn:t.payload.field,sortAsc:!t.payload.isDescending},t.collectionId||"default"))}function*Ft(){yield A(p.LIST_TOGGLE_FILTER,vt),yield A(p.LIST_FILTER_CHANGE,Ot),yield A(p.LIST_CHANGE_SORT_ORDER,xt)}const Gt={"List#root":Ft};_.sagas=Gt;_.constants=pt;_.selectors=Pt;export{_ as L};

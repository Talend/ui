import{r as a,j as c,P as r,X as w,c as E,b as D}from"./iframe-BKTgqfAy.js";import{o as k}from"./omit-RI_1kSX6.js";import{u as y}from"./usePopper-D-8sHgrM.js";import{F as v}from"./FocusManager.component-CQHGC1Oh.js";import{g as R,I as V,u as O}from"./useInputPickerHandlers-sKmMgqOd.js";import{D as L}from"./index-1Sz6aA3P.js";import{G as A}from"./index-CX1LR2gp.js";import{T as j}from"./TimeZone.component-DABNwbOp.js";const N=a.createContext(),H=/^(\d{1,2}):(\d{2})$/,U=/^(\d{1,2}):(\d{2}):(\d{2})$/;function h(e,t){this.message=R(t),this.code=e}function f(e,t){let n=String(e);for(;n.length<(t||2);)n=`0${n}`;return n}function z(e){const t=Number(e);return e===""?new h("INVALID_HOUR","INVALID_HOUR_EMPTY"):e.length!==2||isNaN(t)||t<0||t>23?new h("INVALID_HOUR","INVALID_HOUR_NUMBER"):null}function B(e){const t=Number(e);return e===""?new h("INVALID_MINUTES","INVALID_MINUTES_EMPTY"):e.length!==2||isNaN(t)||t<0||t>59?new h("INVALID_MINUTES","INVALID_MINUTES_NUMBER"):null}function F(e){const t=Number(e);return e===""?new h("INVALID_SECONDS","INVALID_SECONDS_EMPTY"):e.length!==2||isNaN(t)||t<0||t>59?new h("INVALID_SECONDS","INVALID_SECONDS_NUMBER"):null}function $(e){if(!e)throw new h("INVALID_TIME_EMPTY","INVALID_TIME_EMPTY");const{hours:t,minutes:n,seconds:s}=e,o=z(t);if(o)throw o;const i=B(n);if(i)throw i;const u=F(s);if(u)throw u}function K(e,t){const n=t?U:H,s=e.match(n);if(!s)throw new h("TIME_FORMAT_INVALID","TIME_FORMAT_INVALID");const o=s[1],i=s[2],u=t?s[3]:"00";return{hours:o,minutes:i,seconds:u}}function P(e,t){if(!e)return"";const n=f(e.hours),s=f(e.minutes),o=f(e.seconds);return`${n}:${s}${t?`:${o}`:""}`}function q(e){return e?"HH:mm:ss":"HH:mm"}function g(e,t){const n=[];let s;if(!e)return{time:null,textInput:"",errors:[],errorMessage:null};try{s=typeof e=="string"?K(e,t):e,$(s)}catch(o){n.push(o)}return{time:s,textInput:typeof e=="string"?e:P(s,t),errors:n,errorMessage:n[0]?n[0].message:null}}function I(e){const[t,n]=a.useState(()=>g(e.value,e.useSeconds));a.useEffect(()=>{const u=g(e.value,e.useSeconds);u.errorMessage||n(u)},[e.value,e.useSeconds]);function s(u,m,l){n(l),e.onChange&&e.onChange(u,{...l,origin:m})}function o(u){const m=u.target.value,l=g(m,e.useSeconds);s(u,"INPUT",l)}function i(u,{textInput:m,time:l}){s(u,"PICKER",{time:l,textInput:m,errors:[],errorMessage:null})}return c.jsx(N.Provider,{value:{time:{time:t.time,textInput:t.textInput,timezone:e.timezone},inputManagement:{onChange:o,placeholder:q(e.useSeconds)},pickerManagement:{onChange:i}},children:e.children})}I.displayName="Time.Manager";I.defaultProps={useSeconds:!1};I.propTypes={children:r.node,onChange:r.func,useSeconds:r.bool,timezone:r.string,value:r.oneOfType([r.string,r.object])};function S(e){const{time:t,inputManagement:n}=a.useContext(N),{minWidth:s,...o}=e;return c.jsx(V,{inputText:n.placeholder,minWidth:s,children:i=>c.jsx(L,{autoComplete:"off",debounceTimeout:300,element:w.Text,hideLabel:!0,value:t.textInput,style:{width:i},maxLength:n.placeholder.length,...n,...o})})}S.propTypes={minWidth:r.number};S.displayName="Time.Input";const Y="_container_cxvdo_1",G={container:Y};function W(e,t){return e.hours>t.hours||e.hours===t.hours&&e.minutes>t.minutes?!1:!(e.hours===t.hours&&e.minutes===t.minutes&&e.seconds>=t.seconds)}function X({hours:e,minutes:t,...n},s=60){let o=t+s,i=e;return Math.floor(o/60)>0&&(i+=Math.floor(o/60),o%=60),{hours:i,minutes:o,...n}}function Z(e=60,t){const n=[],s={hours:0,minutes:0,seconds:0},o={hours:23,minutes:59,seconds:59};let i=s;for(;W(i,o);)n.push({label:P(i,t),value:i}),i=X(i,e);return n}class J extends a.Component{static propTypes={interval:r.number,onChange:r.func.isRequired,onKeyDown:r.func.isRequired,textInput:r.string,useSeconds:r.bool};static defaultProps={interval:60,useSeconds:!1};constructor(t){super(t),this.onSelect=this.onSelect.bind(this),this.updateHighlightIndex=this.updateHighlightIndex.bind(this),this.scrollItemIntoView=this.scrollItemIntoView.bind(this),this.options=Z(t.interval,t.useSeconds),this.state={hightlightedItemIndex:this.options.findIndex(n=>n.label.includes(t.textInput))}}componentDidMount(){this.props.textInput&&this.scrollItemIntoView(this.props.textInput)}onSelect(t,n,s){this.setState({hightlightedItemIndex:s},()=>this.props.onChange(t,{textInput:n.label,time:{hours:f(n.value.hours),minutes:f(n.value.minutes),seconds:f(n.value.seconds)}}))}scrollItemIntoView(t){const n=this.options.findIndex(s=>s.label.includes(t));if(n){const s=this.containerRef.childNodes[n];s&&s.scrollIntoView({block:"center"}),n!==this.state.hightlightedItemIndex&&this.updateHighlightIndex(n)}}updateHighlightIndex(t){this.setState(({hightlightedItemIndex:n})=>n!==t?{hightlightedItemIndex:t}:null)}render(){return c.jsx("div",{className:G.container,ref:t=>this.containerRef=t,role:"list",children:this.options.map((t,n)=>{const s=E("tc-time-picker-time",{highlight:n===this.state.hightlightedItemIndex}),o={};return n===this.state.hightlightedItemIndex&&(o["aria-current"]="time"),c.jsx("button",{tabIndex:-1,role:"listitem",type:"button",className:s,onClick:i=>this.onSelect(i,t),onKeyDown:i=>this.props.onKeyDown(i,this.containerRef.childNodes[n]),...o,children:t.label},n)})})}}const Q=A.withListGesture(J,!0);function T(e){const{time:t,pickerManagement:n}=a.useContext(N);return c.jsx(Q,{textInput:t.textInput,...e,...n})}T.propTypes={onChange:r.func};T.displayName="Time.Picker";const x={Manager:I,Input:S,Picker:T},ee="_popper_1il4c_1",_={popper:ee,"time-picker":"_time-picker_1il4c_9"};function te(e){let t=e.querySelector('button[aria-current="time"]');t||(t=e.querySelector('button[role="listitem"]')),t.focus()}const ne=["id","required","value","useSeconds","onBlur","onChange","timezone"];function M(e){const t=`time-picker-${e.id||D()}`,n=a.useRef(null),[s,o]=a.useState(null),[i,u]=a.useState(null),{styles:m,attributes:l}=y(s,i,{modifiers:[{name:"hide",enabled:!1},{name:"preventOverflow",enabled:!1}],strategy:"fixed",placement:"bottom-start"}),d=O({disabled:e.disabled,handleBlur:e.onBlur,handleChange:e.onChange,handleKeyDown:()=>te(n.current)}),C=k(e,ne),b=[a.createElement(x.Input,{...C,id:`${e.id}-input`,key:"input",inputRef:o}),d.showPicker&&c.jsx("div",{id:t,className:_.popper,ref:u,style:m.popper,...l.popper,children:c.jsx(x.Picker,{...e})},"popper"),e.timezone&&c.jsx(j,{timezone:e.timezone},"timezone")].filter(Boolean);return c.jsx(x.Manager,{value:e.value,useSeconds:e.useSeconds,timezone:e.timezone,onChange:(...p)=>d.onChange(...p,s),children:c.jsx(v,{className:E(_["time-picker"],"time-picker"),divRef:n,onClick:d.onClick,onFocusIn:d.onFocus,onFocusOut:d.onBlur,onKeyDown:p=>{d.onKeyDown(p,s,n.current)},children:b})})}M.displayName="InputTimePicker";M.propTypes={id:r.string.isRequired,useSeconds:r.bool,onChange:r.func,onBlur:r.func,timezone:r.string,value:r.oneOfType([r.string,r.object]),disabled:r.bool};M.defaultProps={useSeconds:!1};export{M as I,Q as T,$ as c,f as p,K as s,P as t};

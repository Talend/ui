import{r as T,i as E,P as r,j as a,c as D,b as Ae,J as Ne}from"./iframe-tG6QAxGp.js";import{u as Ge}from"./usePopper-D-FRCYGn.js";import{o as Ze}from"./omit-CRo6-3gC.js";import{G as Te,f as Re}from"./index-Bb3pmQxq.js";import{F as Xe}from"./FocusManager.component-Bw2mcafx.js";import{a as Je,s as we,i as Qe}from"./setSeconds-CCs0wN5D.js";import{c as et,f as b,b as W,m as tt,j as st,s as nt}from"./locale-D_pFNwCR.js";import{l as rt,g as Oe,s as ot,a as it,b as L,c as at,i as ct,d as G,e as lt,f as ke,h as dt,j as ut}from"./setYear-BkrZyUGV.js";import{D as Z}from"./index-pACPjwMb.js";import{A as $,a as ht}from"./Action.component-XcQ2WTii.js";import{a as x}from"./translate-Dz4hh4kd.js";import{m as De}from"./memoize-CnCALRJ4.js";import{c as Pe}from"./chunk-BM2XK7uW.js";import{g as mt}from"./locale-ST6-XOnU.js";import{I as w}from"./constants-CZYEPhht.js";import{w as O}from"./withTranslation-CB2voPv-.js";import"./Actions.component-BXy7cgFX.js";import"./ActionButton.component-CFI9Dawz.js";import"./ActionIconToggle.component-DNdEU90S.js";import"./ActionSplitDropdown.component-6Mr2oZ_K.js";const ue=["INVALID_DATE_FORMAT","INVALID_MONTH","INVALID_DAY_NUMBER","INVALID_DAY_OF_MONTH","DATETIME_INVALID_FORMAT","TIME_FORMAT_INVALID"],he=["INVALID_HOUR"],me=["INVALID_MINUTES"],fe=["INVALID_SECONDS"],U="HOURS",j="MINUTES",v="SECONDS",V=T.createContext();function ft(s){switch(s){case"INVALID_HOUR_EMPTY":return E.t("INVALID_HOUR_EMPTY",{defaultValue:"Hour is required"});case"INVALID_HOUR_NUMBER":return E.t("INVALID_HOUR_NUMBER",{defaultValue:"Hour must be between 00 and 23"});case"INVALID_MINUTES_EMPTY":return E.t("INVALID_MINUTES_EMPTY",{defaultValue:"Minutes are required"});case"INVALID_MINUTES_NUMBER":return E.t("INVALID_MINUTES_NUMBER",{defaultValue:"Minutes value must be between 00 and 59"});case"INVALID_SECONDS_EMPTY":return E.t("INVALID_SECONDS_EMPTY",{defaultValue:"Seconds are required"});case"INVALID_SECONDS_NUMBER":return E.t("INVALID_SECONDS_NUMBER",{defaultValue:"Seconds value must be between 00 and 59"});case"INVALID_DATE_FORMAT":return E.t("INVALID_DATE_FORMAT",{defaultValue:"Date format is invalid"});case"INVALID_MONTH_NUMBER":return E.t("INVALID_MONTH_NUMBER",{defaultValue:"Month must be between 01 and 12"});case"INVALID_DAY_NUMBER":return E.t("INVALID_DAY_NUMBER",{defaultValue:"Day is invalid"});case"INVALID_DAY_OF_MONTH":return E.t("INVALID_DAY_OF_MONTH",{defaultValue:"Day value doesn't match an existing day in the month"});case"TIME_FORMAT_INVALID":return E.t("TIME_FORMAT_INVALID",{defaultValue:"Time is invalid"});case"DATETIME_INVALID_FORMAT":return E.t("DATETIME_INVALID_FORMAT",{defaultValue:"Datetime is invalid"});default:return""}}const pt=new RegExp(/^\s*(.*)\s+((.*):(.*)(:.*)?)\s*$/),Tt=new RegExp(/^(.*):(.*)$/),Dt=new RegExp(/^(.*):(.*):(.*)$/),Se=new Date("INTERNAL_INVALID_DATE");function M(s,e){this.message=ft(e),this.code=s}function oe(s,e){let t=String(s);for(;t.length<e;)t=`0${t}`;return t}function It(s,{useUTC:e}){return e?new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()):new Date(s.getFullYear(),s.getMonth(),s.getDate())}function _t(s,{useSeconds:e,useUTC:t}){let n,o,i;return t?(n=s.getUTCHours(),o=s.getUTCMinutes(),i=s.getUTCSeconds()):(n=s.getHours(),o=s.getMinutes(),i=s.getSeconds()),{hours:oe(n,2),minutes:oe(o,2),seconds:e?oe(i,2):"00"}}function Mt(s){const e=s.split(/[^A-Za-z]/),t=s.replace(/[A-Za-z]{4}/g,"([0-9]{4})").replace(/[A-Za-z]{2}/g,"([0-9]{2})");return{partsOrder:e,regexp:new RegExp(`^\\s*${t}\\s*$`)}}function pe({dateFormat:s,useTime:e,useSeconds:t}){return e?`${s} ${t?"HH:mm:ss":"HH:mm"}`:s}function Ve(s,e){return!e.required&&s===void 0?!0:s instanceof Date&&!isNaN(s.getTime())}function Fe(s){const e=Number(s);return s===""?new M("INVALID_HOUR","INVALID_HOUR_EMPTY"):s.length!==2||isNaN(e)||e<0||e>23?new M("INVALID_HOUR","INVALID_HOUR_NUMBER"):null}function Ye(s){const e=Number(s);return s===""?new M("INVALID_MINUTES","INVALID_MINUTES_EMPTY"):s.length!==2||isNaN(e)||e<0||e>59?new M("INVALID_MINUTES","INVALID_MINUTES_NUMBER"):null}function Le(s){const e=Number(s);return s===""?new M("INVALID_SECONDS","INVALID_SECONDS_EMPTY"):s.length!==2||isNaN(e)||e<0||e>59?new M("INVALID_SECONDS","INVALID_SECONDS_NUMBER"):null}function Ie(s){return!(s.hours||s.minutes||s.seconds)}function q(s,e){const{hours:t,minutes:n,seconds:o}=s,{hybridMode:i=!1}=e,c=[];if(i&&Ie(s))return;const u=Fe(t);u&&c.push(u);const d=Ye(n);d&&c.push(d);const h=Le(o);if(h&&c.push(h),c.length>0)throw c}function Et(s,e,t){let n=[];if(!s&&Ie(e)&&!t.required)return n;try{q(e,t)}catch(i){n=n.concat(i)}return Ve(s,t)||n.push(new M("INVALID_DATE_FORMAT","INVALID_DATE_FORMAT")),n}function Ue(s,e,t,n){return q({hours:s,minutes:e,seconds:t},n),Number(s)*3600+Number(e)*60+Number(t)}function je(s,e,t){const{hours:n,minutes:o,seconds:i}=e,{hybridMode:c=!1}=t;if(s===void 0)return t.useTime?t.useSeconds?`${n}:${o}:${i}`:`${n}:${o}`:"";const{dateFormat:u,useTime:d}=t;if(e===void 0||d===!1)return b(s,W(u));const h=s instanceof Date?s:new Date(s);try{const l=Ue(n,o,i,t),m=we(h,l);return c&&Ie(e)?b(m,W(pe({...t,useTime:!1}))):b(m,W(pe(t)))}catch{try{const m=b(h,W(u));return n!==""&&o!==""?t.useSeconds&&i!==""?`${m} ${n}:${o}:${i}`:`${m} ${n}:${o}`:m}catch{return"Invalid Date"}}}function ve(s,e,t){const{useUTC:n,hybridMode:o=!1}=t,{hours:i,minutes:c,seconds:u}=e;if(!(o&&s===void 0)){if(!o&&(s===void 0||e===void 0))return Se;try{const d=Ue(i,c,u,t),h=we(s,d);return n?et(h):h}catch{return Se}}}function $e(s,e){const t=[],{partsOrder:n,regexp:o}=Mt(e),i=s.match(o);if(!i)throw t.push(new M("INVALID_DATE_FORMAT","INVALID_DATE_FORMAT")),t;const c=n.indexOf("YYYY"),u=n.indexOf("MM"),d=n.indexOf("DD"),h=i[u+1],l=parseInt(h,10);(l===0||l>12)&&t.push(new M("INVALID_MONTH","INVALID_MONTH_NUMBER"));const m=i[d+1],f=parseInt(m,10);f===0&&t.push(new M("INVALID_DAY_NUMBER","INVALID_DAY_NUMBER"));const S=i[c+1],I=parseInt(S,10),k=new Date(I,l-1),C=rt(k);if(f>Oe(C)&&t.push(new M("INVALID_DAY_OF_MONTH","INVALID_DAY_OF_MONTH")),t.length>0)throw t;return ot(k,f)}function qe(s,e){const t=e?Dt:Tt,n=s.match(t);if(!n)throw new M("TIME_FORMAT_INVALID","TIME_FORMAT_INVALID");const o=n[1],i=n[2],c=e?n[3]:"00";return{hours:o,minutes:i,seconds:c}}function X({useTime:s,useSeconds:e}){if(s){if(!e)return{hours:"",minutes:"",seconds:"00"}}else return{hours:"00",minutes:"00",seconds:"00"};return{hours:"",minutes:"",seconds:""}}function ye(s){const e=s.split(/[^A-Za-z]/);if(e.indexOf("YYYY")===-1||e.indexOf("MM")===-1||e.indexOf("DD")===-1)throw new Error(`DATE FORMAT ${s} - NOT SUPPORTED. Please provide a composition of YYYY, MM, DD`)}function ge(s,e){let t=X(e);if(!Ve(s,e))return{date:void 0,time:t,datetime:s,textInput:"",errors:[]};const n=It(s,e);return e.useTime&&(t=_t(s,e)),{date:n,time:t,datetime:Je(s),textInput:je(n,t,e),errors:[]}}function bt(s,e,t){let n=[],o=e;if(t.useTime)try{q(e,t)}catch(i){n=n.concat(i)}else o=X(t);return{date:s,time:o,textInput:je(s,o,t),datetime:ve(s,o,t),errorMessage:n[0]?n[0].message:null,errors:n}}function Nt(s,e){let t,n,o=[];try{t=$e(s,e.dateFormat)}catch(i){if(i[0].code!=="INVALID_DATE_FORMAT")o=o.concat(i);else try{n=qe(s,e.useSeconds),q(n,e)}catch(c){o=o.concat(c)}}return{date:t,time:n,errors:o}}function He(s,e){const{hybridMode:t=!1}=e;let n=X(e);if(s==="")return{date:void 0,time:n,datetime:void 0,textInput:s,errors:[]};let o,i=[],c=s,u=!1;try{if(e.useTime){const d=s.match(pt)||[];if(d.length){u=!0,c=d[1];try{const h=d[2];n=qe(h,e.useSeconds),q(n,e)}catch(h){i=i.concat(h)}}else if(!t)throw new M("DATETIME_INVALID_FORMAT","DATETIME_INVALID_FORMAT")}if(t&&!u){const d=Nt(s,e);o=d.date,n=d.time,n||(n={hours:"",minutes:"",seconds:""}),i=i.concat(d.errors)}else try{o=$e(c,e.dateFormat)}catch(d){i=i.concat(d)}}catch(d){i=[d]}return{date:o,time:n,datetime:ve(o,n,e),textInput:s,errors:i,errorMessage:i[0]?i[0].message:null}}function xe(s,e){const t=typeof s;return t==="number"?ge(new Date(s),e):t==="string"?He(s,e):s instanceof Date?ge(s,e):{date:void 0,time:X(e),datetime:void 0,textInput:"",errors:[]}}class St extends T.Component{static displayName="DateTime.Manager";static propTypes={children:r.node,dateFormat:r.string,formMode:r.bool,id:r.string.isRequired,onChange:r.func,hybridMode:r.bool,required:r.bool,selectedDateTime:r.oneOfType([r.instanceOf(Date),r.number,r.string]),useSeconds:r.bool,useTime:r.bool,useUTC:r.bool};static defaultProps={dateFormat:"YYYY-MM-DD",formMode:!1,hybridMode:!1,required:!0,useSeconds:!1,useTime:!1,useUTC:!1};constructor(e){super(e),ye(e.dateFormat),this.inputErrorId=`${e.id}-input-error`,this.hoursErrorId=`${e.id}-hours-error`,this.minutesErrorId=`${e.id}-minutes-error`,this.secondsErrorId=`${e.id}-seconds-error`,this.initialState=xe(e.selectedDateTime,this.getDateOptions()),this.state={...this.initialState,previousErrors:[]},this.onInputFocus=this.onInputFocus.bind(this),this.hasError=this.hasError.bind(this),this.onReset=this.onReset.bind(this),this.onSubmit=this.onSubmit.bind(this),this.onInputChange=this.onInputChange.bind(this),this.onPickerChange=this.onPickerChange.bind(this)}componentDidUpdate(e,t){const n=this.props.selectedDateTime,o=n!==e.selectedDateTime&&n!==t.datetime&&!Qe(n,t.datetime);if(e.dateFormat!==this.props.dateFormat&&ye(this.props.dateFormat),o){const i=xe(n,this.getDateOptions());this.setState(i)}}onChange(e,t){if(!this.props.onChange)return;const{errorMessage:n,datetime:o,textInput:i,errors:c}=this.state;this.initialState={...this.state},this.props.onChange(e,{errors:c,errorMessage:n,datetime:o,textInput:i,origin:t})}onInputChange(e){const t=e.target.value,n=He(t,this.getDateOptions());this.setState(o=>({previousErrors:o.errors,...n}),()=>{this.props.formMode||this.onChange(e,"INPUT")})}onPickerChange(e,{date:t,time:n,field:o}){const i=bt(t,n,this.getDateOptions()),c=[U,j,v].includes(o),u=!i.time.hours&&!i.time.minutes&&!i.time.seconds,d=this.getDateOptions().hybridMode;let h=this.state.errors.filter(l=>!ue.includes(l.code)).concat(i.errors.filter(l=>ue.includes(l.code)));if(c)if(d&&u)h=h.filter(l=>!he.includes(l.code)&&!me.includes(l.code)&&!fe.includes(l.code));else{let l;switch(o){case U:l=Fe(n.hours,this.getDateOptions().hybridMode);break;case j:l=Ye(n.minutes,this.getDateOptions().hybridMode);break;case v:l=Le(n.seconds,this.getDateOptions().hybridMode);break}h=h.filter(m=>o===U&&!he.includes(m.code)||o===j&&!me.includes(m.code)||o===v&&!fe.includes(m.code)),l&&h.push(l)}this.setState({previousErrors:this.state.errors,...i,errors:h},()=>{this.props.formMode||this.onChange(e,"PICKER")})}onSubmit(e,t){e.preventDefault();let n=Et(this.state.date,this.state.time,this.getDateOptions());n=this.state.errors.filter(({code:o})=>!n.find(i=>i.code===o)).concat(n),this.setState({errors:n,errorMessage:n[0]?n[0].message:""},()=>{n.length||this.onChange(e,t)})}onInputFocus(e,t){this.setState({focusedInput:t})}onReset(){this.props.formMode&&this.setState({...this.initialState})}getDateOptions(){return{dateFormat:this.props.dateFormat,useTime:this.props.useTime,useSeconds:this.props.useSeconds,useUTC:this.props.useUTC,required:this.props.required,hybridMode:this.props.hybridMode}}hasError(e){if(!this.props.formMode)return!1;const t=Array.isArray(e)?e:[e];return!!this.state.errors.find(n=>t.indexOf(n.code)>-1)}render(){return a.jsx(V.Provider,{value:{datetime:{textInput:this.state.textInput,date:this.state.date,time:this.state.time},errorManagement:{onInputFocus:this.onInputFocus,focusedInput:this.state.focusedInput,errors:this.state.errors,hasError:this.hasError,formMode:this.props.formMode,inputErrorId:this.inputErrorId,hoursErrorId:this.hoursErrorId,minutesErrorId:this.minutesErrorId,secondsErrorId:this.secondsErrorId},inputManagement:{inputRef:e=>{this.inputRef=e},onChange:this.onInputChange,placeholder:pe(this.getDateOptions())},pickerManagement:{onSubmit:this.onPickerChange,useTime:this.props.useTime,useSeconds:this.props.useSeconds,useUTC:this.props.useUTC},formManagement:{onReset:this.onReset,onSubmit:this.onSubmit}},children:this.props.children})}}function We(s){const{datetime:e,inputManagement:t,errorManagement:n}=T.useContext(V);return a.jsx(Z,{"aria-describedby":n.inputErrorId,autoComplete:"off",className:"form-control",debounceTimeout:300,onFocus:n.onInputFocus,type:"text",value:e.textInput,...t,...s})}We.displayName="DateTime.Input";function yt(){return{locale:mt()}}const J=De(yt);function gt(s=1,e){const t=J(e);return new Array(7).fill(0).map((n,o)=>(o+s)%7).map(n=>at(new Date(0),n)).map(n=>({abbr:b(n,"EEEEE",t),full:b(n,"EEEE",t)}))}function xt(s,e,t=1){const n=new Date(s,e),o=tt(n,{weekStartsOn:t}),i=new Array(42).fill(0).map((c,u)=>st(o,u));return Pe(i,7)}function Ct(s,e){const t=J(e),n=new Array(12).fill(0).map((o,i)=>i).map(o=>({index:o,name:b(it(new Date(0),o),"MMMM",t)}));return Pe(n,s)}function ie(s,e=3){const t=s===void 0?L(new Date):s,n=t-e,o=t+e,i=[];for(let c=n;c<=o;c+=1)i.push(c);return i}const At="_container_1ioka_3",Rt="_selected_1ioka_33",wt="_today_1ioka_52",y={container:At,"calendar-header":"_calendar-header_1ioka_8","calendar-row":"_calendar-row_1ioka_26","calendar-day":"_calendar-day_1ioka_30",selected:Rt,today:wt,"not-current-month":"_not-current-month_1ioka_57"},Ot=De(gt);class Q extends T.PureComponent{constructor(e){super(e),this.getWeeks=De(xt,(t,n,o)=>`${t}-${n}|${o}`)}isSelectedDate(e){return this.props.selectedDate!==void 0&&ct(this.props.selectedDate,e)}isDisabledDate(e){return this.props.isDisabledChecker?this.props.isDisabledChecker(e):!1}isCurrentMonth(e){return G(e)===this.props.calendar.monthIndex}isCurrentYear(e){return L(e)===this.props.calendar.year}isSelectedInCurrentCalendar(){const{selectedDate:e}=this.props;return e?this.isCurrentYear(e)&&this.isCurrentMonth(e):!1}selectDate(e,t,n,o){this.isCurrentMonth(t)||(t<lt(new Date(n,o))?this.props.goToPreviousMonth():this.props.goToNextMonth()),this.props.onSelect(e,t)}render(){const{calendar:e,t}=this.props,{year:n,monthIndex:o}=e,i=J(t),c=this.getWeeks(n,o,1),u=Ot(void 0,this.props.t),d=this.isSelectedInCurrentCalendar(),h=b(ke(new Date(0),o),"MMMM",i);return a.jsxs("table",{className:y.container,ref:l=>{this.calendarRef=l},children:[a.jsx("caption",{className:"sr-only",children:`${h} ${n}`}),a.jsx("thead",{children:a.jsx("tr",{className:y["calendar-header"],children:u.map((l,m)=>a.jsx("th",{scope:"col",children:a.jsx("abbr",{title:l.full,children:l.abbr},m)},m))})}),a.jsx("tbody",{children:c.map((l,m)=>a.jsx("tr",{className:D(y["calendar-row"],"tc-date-picker-calendar-row"),children:l.map((f,S)=>{const I=Oe(f),k=this.isDisabledDate(f),C=this.isSelectedDate(f),H=dt(f),se=d&&C||!d&&I===1,ne=D(y["calendar-day"],{[y.selected]:C,[y.today]:H,[y["not-current-month"]]:!this.isCurrentMonth(f)},"tc-date-picker-day","btn-tertiary","btn-default");let A=b(f,"EEEE dd MMMM yyyy",i);const F={key:S,className:y["calendar-col"]};C&&(F["aria-current"]="date",A=t("DATEPICKER_DAY_SELECTED",{defaultValue:"{{date}}, selected",date:A})),H&&(A=t("DATEPICKER_DAY_TODAY",{defaultValue:"Today, {{date}}",date:A}));const re=this.isCurrentMonth(f)?{"data-value":I}:void 0;return a.jsx("td",{...F,children:a.jsx("button",{type:"button",className:ne,onClick:P=>this.selectDate(P,f,n,o),disabled:k,tabIndex:this.props.allowFocus&&se?0:-1,onKeyDown:P=>this.props.onKeyDown(P,this.calendarRef,I-1),"aria-label":A,...re,children:I})})})},m))})]})}}Q.displayName="DatePicker";Q.propTypes={allowFocus:r.bool,calendar:r.shape({monthIndex:r.number.isRequired,year:r.number.isRequired}).isRequired,onSelect:r.func.isRequired,selectedDate:r.instanceOf(Date),isDisabledChecker:r.func,onKeyDown:r.func.isRequired,t:r.func,goToPreviousMonth:r.func.isRequired,goToNextMonth:r.func.isRequired};Q.defaultProps={t:x()};const kt=Te.withCalendarGesture(Q),Pt=O(w)(kt),Vt="_utc_1hokq_16",g={"time-picker":"_time-picker_1hokq_5",utc:Vt,"time-input":"_time-input_1hokq_25","time-error":"_time-error_1hokq_34"};class Ft extends T.PureComponent{static defaultProps={value:{},t:x()};static propTypes={allowFocus:r.bool,onChange:r.func.isRequired,value:r.shape({hours:r.string,minutes:r.string,seconds:r.string}),useSeconds:r.bool,useUTC:r.bool,t:r.func};constructor(e){super(e);const t=Ae();this.hourId=`${t}-hour`,this.minuteId=`${t}-minute`,this.secondId=`${t}-second`,this.onChange=this.onChange.bind(this)}onChange(e,t){const n=e.target.value,o={...this.props.value};t===U?o.hours=n.trim():t===j?o.minutes=n.trim():t===v&&(o.seconds=n.trim()),this.props.onChange(e,o,t)}render(){const{t:e}=this.props,t=this.props.allowFocus?0:-1;return a.jsx(V.Consumer,{children:({errorManagement:n})=>{const{onInputFocus:o,hasError:i,formMode:c,hoursErrorId:u,minutesErrorId:d,secondsErrorId:h}=n;return a.jsxs("div",{className:D("tc-date-picker-time",g["time-picker"]),children:[a.jsxs("legend",{children:[e("DATEPICKER_TIME",{defaultValue:"Time"}),this.props.useUTC?a.jsx("div",{className:g.utc,children:e("DATEPICKER_UTC",{defaultValue:"UTC"})},"utc"):null]},"legend"),a.jsx("label",{htmlFor:this.hourId,className:"sr-only",children:e("DATEPICKER_TIME_HOURS",{defaultValue:"hours"})},"hour-label"),a.jsx(Z,{id:this.hourId,className:D(g["time-input"],{[g["time-error"]]:i("INVALID_HOUR")}),value:this.props.value.hours,tabIndex:t,onChange:l=>this.onChange(l,U),onBlur:o,onFocus:l=>o(l,u),placeholder:"HH","aria-required":c,"aria-invalid":i("INVALID_HOUR"),"aria-describedby":u},"hour-input"),a.jsx("hr",{},"hr-minutes"),a.jsx("label",{htmlFor:this.minuteId,className:"sr-only",children:e("DATEPICKER_TIME_MINUTES",{defaultValue:"minutes"})},"minutes-label"),a.jsx(Z,{id:this.minuteId,className:D(g["time-input"],{[g["time-error"]]:i("INVALID_MINUTES")}),value:this.props.value.minutes,tabIndex:t,onChange:l=>this.onChange(l,j),onBlur:o,onFocus:l=>o(l,d),placeholder:"MM","aria-required":c,"aria-invalid":i("INVALID_MINUTES"),"aria-describedby":d},"minutes-input"),this.props.useSeconds&&[a.jsx("hr",{},"hr-seconds"),a.jsx("label",{htmlFor:this.secondId,className:"sr-only",children:this.props.t("DATEPICKER_TIME_SECONDS",{defaultValue:"Seconds"})},"seconds-label"),a.jsx(Z,{id:this.secondId,className:D(g["time-input"],{[g["time-error"]]:i("INVALID_SECONDS")}),value:this.props.value.seconds,tabIndex:t,onBlur:o,onFocus:l=>o(l,h),onChange:l=>this.onChange(l,v),placeholder:"SS","aria-required":c,"aria-invalid":i("INVALID_SECONDS"),"aria-describedby":h},"seconds-input")]]})}})}}const Yt=O(w)(Ft),Lt="_scroll_1j0bo_12",Ut="_year_1j0bo_2",jt="_selected_1j0bo_22",R={"year-picker":"_year-picker_1j0bo_2",scroll:Lt,year:Ut,selected:jt},ae=7,ce=3;class vt extends T.Component{static propTypes={selectedYear:r.number,onSelect:r.func.isRequired,t:r.func};static defaultProps={t:x()};constructor(e){super(e),this.onWheel=this.onWheel.bind(this),this.scrollUp=this.scroll.bind(this,-1,null),this.scrollDown=this.scroll.bind(this,1,null),this.goToPreviousPage=this.scroll.bind(this,-ae),this.goToNextPage=this.scroll.bind(this,ae),this.state={yearsWindow:ie(e.selectedYear,ce)}}componentDidUpdate(e){const t=e.selectedYear,n=this.props.selectedYear;n&&n!==t&&!this.state.yearsWindow.includes(n)&&this.setState({yearsWindow:ie(n,ce)})}onWheel(e){e.preventDefault();const{deltaY:t}=e,n=Math.round(Math.log(Math.abs(t)));let o=t>0?1:-1;n>=5&&(o*=Math.floor(n/2)),this.scroll(o)}getMiddleYear(){const{yearsWindow:e}=this.state;return e[Math.floor(e.length/2)]}scroll(e,t){this.setState(()=>({yearsWindow:ie(this.getMiddleYear()+e,ce)}),t)}render(){const{selectedYear:e,t}=this.props,{yearsWindow:n}=this.state,o=n.includes(e),i=this.getMiddleYear();return a.jsx(Te.WithDynamicListGesture,{className:R["year-picker"],goToPreviousPage:this.goToPreviousPage,goToNextPage:this.goToNextPage,children:c=>[a.jsx($,{className:D(R.scroll,R["scroll-up"],"tc-date-picker-scroll-up"),icon:"talend-chevron-left",iconTransform:"rotate-90",label:t("DATEPICKER_YEAR_PREVIOUS",{defaultValue:"Go to previous year"}),onClick:this.scrollUp,tabIndex:"-1",link:!0,hideLabel:!0},"previousPage"),a.jsx("ol",{onWheel:this.onWheel,children:n.map((u,d)=>{const h=u===e;let l=-1;(h||!o&&u===i)&&(l=0);let m;const f={};h&&(f["aria-current"]=!0,m=t("DATEPICKER_YEAR_SELECTED",{defaultValue:"{{year}}, selected",year:u}));const S=D(R.year,{[R.selected]:h},"tc-date-picker-year");return T.createElement("li",{...f,key:u},a.jsx("button",{type:"button",className:S,onClick:I=>this.props.onSelect(I,u),tabIndex:l,onKeyDown:I=>c(I,{index:d,size:ae}),"aria-label":m,children:u}))})},"list"),a.jsx($,{className:D(R.scroll,R["scroll-down"],"tc-date-picker-scroll-down"),icon:"talend-chevron-left",iconTransform:"rotate-270",label:t("DATEPICKER_YEAR_NEXT",{defaultValue:"Go to next year"}),onClick:this.scrollDown,tabIndex:"-1",link:!0,hideLabel:!0},"nextPage")]})}}const $t=O(w)(vt),qt="_common_ik112_3",Ht="_month_ik112_13",Wt="_button_ik112_17",B={common:qt,month:Ht,button:Wt};function _e(s){const e=!!s.button,n={className:D(B.common,{[B.button]:e},{"btn-tertiary btn-info":e},s.className),...e?s.button:{}},o=J(),i=ut(ke(new Date(0),s.monthIndex),s.year),c=b(i,"MMMM yyyy",o),u=b(i,"yyyy",o),d=b(i,"MMMM",o);return e?a.jsx($,{...n,label:c}):a.jsxs("div",{className:B.common,children:[a.jsx("div",{className:B.month,children:a.jsx("span",{...n,children:d})}),a.jsx(ht,{className:"btn-tertiary btn-info",label:u,children:a.jsx($t,{id:"year-picker-in-datetime-header","data-feature":"actiondropdown.items",onSelect:s.onSelectYear})})]})}_e.propTypes={monthIndex:r.number.isRequired,year:r.number.isRequired,button:r.object,className:r.string,onSelectYear:r.func,t:r.func};const Bt="_container_cfj2x_2",Kt="_header_cfj2x_7",zt="_body_cfj2x_21",N={container:Bt,header:Kt,body:zt,"element-container":"_element-container_cfj2x_24"};function Me(s){const{leftElement:e,middleElement:t,rightElement:n}=s.header;return a.jsxs("div",{className:N.container,children:[a.jsxs("div",{className:N.header,children:[a.jsx("div",{className:D(N["element-container"],N.left),children:e}),a.jsx("div",{className:D(N["element-container"],N.middle),children:t}),a.jsx("div",{className:D(N["element-container"],N.right),children:n})]}),a.jsx("div",{className:D(N["element-container"],N.body),children:s.bodyElement})]})}Me.propTypes={header:r.shape({leftElement:r.element,middleElement:r.element,rightElement:r.element}).isRequired,bodyElement:r.element.isRequired};const Gt="_body_sx7dm_2",Zt="_date_sx7dm_5",Xt="_time_sx7dm_8",le={body:Gt,date:Zt,time:Xt};function Jt(s,e){const t=(s%e+e)%e;return t<0?t+Math.abs(e):t}class Qt extends T.PureComponent{static propTypes={allowFocus:r.bool,calendar:r.shape({monthIndex:r.number.isRequired,year:r.number.isRequired}).isRequired,onTitleClick:r.func.isRequired,onSelectMonthYear:r.func.isRequired,onSelectDate:r.func.isRequired,onSelectTime:r.func.isRequired,selectedDate:r.instanceOf(Date),selectedTime:r.shape({hours:r.oneOfType([r.number,r.string]),minutes:r.oneOfType([r.number,r.string])}),useSeconds:r.bool,useTime:r.bool,useUTC:r.bool,t:r.func};static defaultProps={t:x()};constructor(e){super(e),this.goToPreviousMonth=this.incrementMonthIndex.bind(this,-1),this.goToNextMonth=this.incrementMonthIndex.bind(this,1)}getTimePicker(){return a.jsx("div",{className:le.time,children:a.jsx(Yt,{allowFocus:this.props.allowFocus,value:this.props.selectedTime,onChange:this.props.onSelectTime,useSeconds:this.props.useSeconds,useUTC:this.props.useUTC})},"time")}incrementMonthIndex(e,t){const n=this.props.calendar.monthIndex+e,o=Jt(n,12),i=Math.floor(n/12),c=this.props.calendar.year+i;this.props.onSelectMonthYear({monthIndex:o,year:c},t)}render(){const{t:e}=this.props,t={leftElement:a.jsx(Ne,{size:"S",icon:"arrow-left",onClick:()=>this.goToPreviousMonth(),tabIndex:"-1",children:e("DATEPICKER_MONTH_PREVIOUS","Go to previous month")}),middleElement:a.jsx(_e,{monthIndex:this.props.calendar.monthIndex,year:this.props.calendar.year,button:{"aria-label":e("DATEPICKER_TO_MONTH_YEAR",{defaultValue:"Switch to month-and-year view"}),onClick:this.props.onTitleClick,tabIndex:this.props.allowFocus?0:-1}}),rightElement:a.jsx(Ne,{size:"S",icon:"arrow-right",onClick:()=>this.goToNextMonth(),tabIndex:"-1",children:e("DATEPICKER_MONTH_NEXT","Go to next month")})},n=a.jsxs("div",{className:le.body,children:[a.jsx("div",{className:le.date,children:a.jsx(Pt,{allowFocus:this.props.allowFocus,calendar:this.props.calendar,selectedDate:this.props.selectedDate,onSelect:this.props.onSelectDate,goToPreviousMonth:this.goToPreviousMonth,goToNextMonth:this.goToNextMonth})},"date"),this.props.useTime&&this.getTimePicker()]});return a.jsx(Me,{header:t,bodyElement:n})}}const es=O(w)(Qt),ts="_container_nqf5o_2",ss="_selected_nqf5o_27",Y={container:ts,"calendar-row":"_calendar-row_nqf5o_9","calendar-col":"_calendar-col_nqf5o_16","calendar-month":"_calendar-month_nqf5o_24",selected:ss},Be=3;class ee extends T.PureComponent{constructor(e){super(e),this.months=Ct(Be,e.t)}render(){const{t:e,selectedYear:t}=this.props;return a.jsxs("table",{className:Y.container,ref:n=>{this.monthPickerRef=n},children:[a.jsx("caption",{className:"sr-only",children:e("DATEPICKER_MONTHS_TITLE",{defaultValue:"Year {{year}}",year:t})}),a.jsx("tbody",{children:this.months.map((n,o)=>a.jsx("tr",{className:Y["calendar-row"],children:n.map(({index:i,name:c})=>{const u=i===this.props.selectedMonthIndex,d=D(Y["calendar-month"],{[Y.selected]:u},"tc-date-picker-month");let h=`${c} ${t}`;const l={key:i,className:Y["calendar-col"]};return u&&(l["aria-current"]="date",h=e("DATEPICKER_SELECTED_MONTH",{defaultValue:"{{monthYear}}, selected",monthYear:h})),a.jsx("td",{...l,children:a.jsx("button",{"data-value":i,type:"button",className:d,onClick:m=>{this.props.onSelect(m,i)},tabIndex:this.props.allowFocus&&u?0:-1,onKeyDown:m=>this.props.onKeyDown(m,this.monthPickerRef,i),"aria-label":h,children:c})},i)})},o))})]})}}ee.displayName="MonthPicker";ee.propTypes={allowFocus:r.bool,onKeyDown:r.func.isRequired,onSelect:r.func.isRequired,selectedMonthIndex:r.number,selectedYear:r.number,t:r.func};ee.defaultProps={t:x()};const ns=Te.withMonthCalendarGesture(ee,Be),rs=O(w)(ns);function Ee(s){const e={leftElement:a.jsx($,{label:"","aria-label":s.t("DATEPICKER_TO_DATE_VIEW",{defaultValue:"Switch to date-and-time view"}),icon:"talend-arrow-left",onClick:s.onBackClick,tabIndex:s.allowFocus?0:-1,className:"btn-tertiary btn-info"}),middleElement:a.jsx(_e,{monthIndex:s.selectedMonthIndex,year:s.selectedYear,onSelectYear:s.onSelectYear})},t=a.jsx(rs,{allowFocus:s.allowFocus,selectedMonthIndex:s.selectedMonthIndex,selectedYear:s.selectedYear,onSelect:s.onSelectMonth});return a.jsx(Me,{header:e,bodyElement:t})}Ee.propTypes={allowFocus:r.bool,selectedMonthIndex:r.number.isRequired,selectedYear:r.number.isRequired,onBackClick:r.func.isRequired,onSelectMonth:r.func.isRequired,onSelectYear:r.func.isRequired,t:r.func};Ee.defaultProps={t:x()};const os=O(w)(Ee),is="_container_1d652_3",as="_footer_1d652_10",de={container:is,footer:as,"date-padding":"_date-padding_1d652_19"};class be extends T.Component{constructor(e){super(e);const t=e.selection.date,n=e.selection.time,o=t===void 0?new Date:t;this.state={isDateTimeView:!0,calendar:{monthIndex:G(o),year:L(o)},selectedDate:t,selectedTime:n,allowFocus:!e.manageFocus},this.onSelectCalendarMonth=this.onSelectCalendarMonth.bind(this),this.onSelectCalendarYear=this.onSelectCalendarYear.bind(this),this.onSelectCalendarMonthYear=this.onSelectCalendarMonthYear.bind(this),this.onSelectDate=this.onSelectDate.bind(this),this.onSelectTime=this.onSelectTime.bind(this),this.allowFocus=this.setAllowFocus.bind(this,!0),this.disallowFocus=this.setAllowFocus.bind(this,!1),this.setDateTimeView=this.setView.bind(this,!0),this.setMonthYearView=this.setView.bind(this,!1),this.onClickToday=this.onClickToday.bind(this)}componentDidMount(){this.props.manageFocus&&(this.pickerRef.addEventListener("focusin",this.allowFocus),this.pickerRef.addEventListener("focusout",this.disallowFocus))}componentDidUpdate(e){const t=this.props.selection.date,n=this.props.selection.time,o=e.selection.date!==t,i=e.selection.time!==n,c=o&&t!==this.state.selectedDate,u=i&&n!==this.state.selectedTime;if(!c&&!u)return;const d={selectedDate:t,selectedTime:n};c&&t&&(d.calendar={monthIndex:G(t),year:L(t)}),this.setState(d)}componentWillUnmount(){this.props.manageFocus&&(this.pickerRef.removeEventListener("focusin",this.allowFocus),this.pickerRef.removeEventListener("focusout",this.disallowFocus))}onSelectDate(e,t){e.persist(),this.setState({selectedDate:t},()=>{this.submit(e)})}onSelectTime(e,t,n){e.persist(),this.setState({selectedTime:t},()=>{this.submit(e,n)})}onSelectCalendarMonthYear(e,t){this.setState(n=>({calendar:{...n.calendar,...e}}),t)}onSelectCalendarMonth(e,t){this.onSelectCalendarMonthYear({monthIndex:t})}onSelectCalendarYear(e,t){this.onSelectCalendarMonthYear({year:t})}onClickToday(e){const t=new Date;this.state.isDateTimeView||(this.onSelectCalendarYear(e,L(t)),this.onSelectCalendarMonth(e,G(t)),this.setView(!0)),this.onSelectDate(e,nt(t))}setAllowFocus(e){this.setState({allowFocus:e})}setView(e){this.setState({isDateTimeView:e},()=>{Re(this.pickerRef)})}submit(e,t){this.props.onSubmit(e,{date:this.state.selectedDate,time:this.state.selectedTime,field:t})}render(){let e;return this.state.isDateTimeView?e=a.jsx(es,{allowFocus:this.state.allowFocus,calendar:this.state.calendar,onSelectDate:this.onSelectDate,onSelectMonthYear:this.onSelectCalendarMonthYear,onSelectTime:this.onSelectTime,onTitleClick:this.setMonthYearView,selectedDate:this.state.selectedDate,selectedTime:this.state.selectedTime,useSeconds:this.props.useSeconds,useTime:this.props.useTime,useUTC:this.props.useUTC}):e=a.jsx(os,{allowFocus:this.state.allowFocus,onBackClick:this.setDateTimeView,onSelectMonth:this.onSelectCalendarMonth,onSelectYear:this.onSelectCalendarYear,selectedMonthIndex:this.state.calendar.monthIndex,selectedYear:this.state.calendar.year}),a.jsxs("div",{className:de.container,ref:t=>{this.pickerRef=t},tabIndex:this.state.allowFocus?0:-1,"aria-label":"Date picker",children:[e,a.jsx("div",{className:D(de.footer,{[de["date-padding"]]:this.state.isDateTimeView}),children:a.jsx($,{label:this.props.t("DATEPICKER_TODAY",{defaultValue:"Today"}),"aria-label":this.props.t("DATEPICKER_PICK_TODAY",{defaultValue:"Pick Today"}),onClick:this.onClickToday,className:"btn-tertiary btn-info"})})]})}}be.propTypes={manageFocus:r.bool,selection:r.shape({date:r.instanceOf(Date),time:r.shape({hours:r.oneOfType([r.number,r.string]),minutes:r.oneOfType([r.number,r.string])})}),onSubmit:r.func.isRequired,useSeconds:r.bool,useTime:r.bool,useUTC:r.bool,t:r.func};be.defaultProps={t:x(),selection:{}};function Ke(s){const{datetime:e,pickerManagement:t}=T.useContext(V);return a.jsx(be,{manageFocus:!0,selection:{date:e.date,time:e.time},...t,...s})}Ke.displayName="DateTime.Picker";function K({hidden:s,errors:e,id:t}){const n=D({"sr-only":s});return a.jsx("div",{id:t,className:n,"aria-hidden":s,children:e.map((o,i)=>a.jsx("span",{"data-testid":o.code,children:o.message},i))})}const cs="_validation_rxnik_2",ls="_errors_rxnik_10",Ce={validation:cs,errors:ls};function te({t:s}){const{errorManagement:e,formManagement:t}=T.useContext(V),{errors:n,focusedInput:o,hoursErrorId:i,minutesErrorId:c,secondsErrorId:u,inputErrorId:d}=e,h=[d,i,c,u],l={[d]:n.filter(f=>ue.includes(f.code)),[i]:n.filter(f=>he.includes(f.code)),[c]:n.filter(f=>me.includes(f.code)),[u]:n.filter(f=>fe.includes(f.code))};let m=o;return m||(m=h.find(f=>l[f].length)),a.jsxs("div",{className:Ce.validation,children:[a.jsxs("div",{className:Ce.errors,children:[a.jsx(K,{id:d,errors:l[d],hidden:m!==d},"input-errors"),a.jsx(K,{id:i,errors:l[i],hidden:m!==i},"hours-errors"),a.jsx(K,{id:c,errors:l[c],hidden:m!==c},"minutes-errors"),a.jsx(K,{id:u,errors:l[u],hidden:m!==u},"seconds-errors")]}),a.jsx("button",{name:"action-datepicker-validate",className:"btn btn-primary",type:"button","aria-label":s("DATEPICKER_VALIDATE_DESC",{defaultValue:"Validate date value"}),onClick:t.onSubmit,children:s("DATEPICKER_VALIDATE",{defaultValue:"Done"})})]})}te.displayName="DateTime.Validation";te.propTypes={t:r.func};te.defaultProps={t:x()};const ds=O(w)(te),z={Manager:St,Input:We,Picker:Ke,Validation:ds},us="_popper_19n88_2",hs={popper:us},ms=["dateFormat","formMode","id","required","selectedDateTime","useSeconds","useTime","useUTC","onBlur","onChange","hybridMode","isDisabledChecker"];function fs(s){s.stopPropagation()}function ze(s){const e=T.useRef(null),[t,n]=T.useState(!1),[o,i]=T.useState(!1),[c,u]=T.useState(null),[d,h]=T.useState(null),{styles:l,attributes:m}=Ge(c,d,{modifiers:[{name:"hide",enabled:!1},{name:"preventOverflow",enabled:!1}],strategy:"fixed",placement:A()}),f=`date-time-picker-${s.id||Ae()}`,S=p=>F(!0,p),I=p=>F(!1,p);function k(p,{onReset:_}){switch(p.key){case"Esc":case"Escape":_(),c.focus(),I();break;case"Down":case"ArrowDown":if(p.target!==c)return;t?Re(e.current):S();break}}function C(p,{onReset:_}){_(),I(!1),s.onBlur&&s.onBlur(p)}function H(){o||S()}function se(){S()}function ne(p,_){s.onChange(p,_),(s.formMode||!s.formMode&&!s.useTime&&_.origin!=="INPUT")&&(c.focus(),I(!0))}function A(){const p=c;return p&&p.getBoundingClientRect().left>window.innerWidth/2?"bottom-end":"bottom-start"}function F(p,_){s.readOnly||(n(p),i(_))}const re=Ze(s,ms),P=[T.createElement(z.Input,{...re,id:`${s.id}-input`,key:"input",inputRef:u}),t&&a.jsxs("div",{id:f,className:hs.popper,onMouseDown:fs,ref:h,style:l.popper,...m.popper,children:[a.jsx(z.Picker,{}),s.formMode&&a.jsx(z.Validation,{})]},"popper")].filter(Boolean);return a.jsx(z.Manager,{dateFormat:s.dateFormat,formMode:s.formMode,id:s.id,required:s.required,selectedDateTime:s.selectedDateTime,useSeconds:s.useSeconds,useTime:s.useTime,useUTC:s.useUTC,hybridMode:s.hybridMode,onChange:ne,children:a.jsx(V.Consumer,{children:({formManagement:p})=>a.jsx(Xe,{divRef:e,onClick:se,onFocusIn:H,onFocusOut:_=>{C(_,p)},onKeyDown:_=>{k(_,p)},children:s.formMode?a.jsx("form",{onSubmit:p.onSubmit,children:P},"form"):P})})})}ze.defaultProps={dateFormat:"YYYY-MM-DD",hybridMode:!1,useSeconds:!1,useTime:!1,useUTC:!1,formMode:!1,required:!0};ze.propTypes={id:r.string.isRequired,selectedDateTime:r.oneOfType([r.instanceOf(Date),r.number,r.string]),onChange:r.func,onBlur:r.func,readOnly:r.bool,dateFormat:r.string,useSeconds:r.bool,useTime:r.bool,useUTC:r.bool,hybridMode:r.bool,formMode:r.bool,required:r.bool};export{ze as I};

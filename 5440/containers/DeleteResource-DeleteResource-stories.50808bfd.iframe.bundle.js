"use strict";(self.webpackChunk_talend_react_containers=self.webpackChunk_talend_react_containers||[]).push([[358],{"./src/DeleteResource/DeleteResource.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>DeleteResource_stories});var lib_esm=__webpack_require__("../cmf/lib-esm/index.js"),immutable=__webpack_require__("../../node_modules/immutable/dist/immutable.js"),immutable_default=__webpack_require__.n(immutable),react=__webpack_require__("../../node_modules/react/index.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),es=__webpack_require__("../../node_modules/react-i18next/dist/es/index.js"),i18next=__webpack_require__("../../node_modules/i18next/dist/esm/i18next.js");(0,es.TO)()||(console.warn("@talend/react-containers used without i18n host."),(0,es.Vx)(i18next.Ay.createInstance({},(()=>{}))));const constants={DIALOG_BOX_DELETE_RESOURCE:"DIALOG_BOX_DELETE_RESOURCE",DIALOG_BOX_DELETE_RESOURCE_OK:"DIALOG_BOX_DELETE_RESOURCE_OK",DIALOG_BOX_DELETE_RESOURCE_CANCEL:"DIALOG_BOX_DELETE_RESOURCE_CANCEL",DIALOG_BOX_DELETE_RESOURCE_SUCCESS:"DIALOG_BOX_DELETE_RESOURCE_SUCCESS",DIALOG_BOX_DELETE_RESOURCE_ERROR:"DIALOG_BOX_DELETE_RESOURCE_ERROR",DIALOG_BOX_DELETE_RESOURCE_CLOSE:"DIALOG_BOX_DELETE_RESOURCE_CLOSE",VALIDATE_ACTION:"validate-action",CANCEL_ACTION:"cancel-action"};var components_lib_esm=__webpack_require__("../components/lib-esm/index.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class DeleteResource extends react.Component{constructor(props){super(props),this.getLabelInfo=this.getLabelInfo.bind(this),this.getResourceInfo=this.getResourceInfo.bind(this),this.onHide=this.onHide.bind(this)}onHide(event){this.props.dispatchActionCreator("DeleteResource#cancel",event,{model:this.getResourceInfo()})}getLabelInfo(){return{label:(resource=this.props.resource,resource&&(resource.get("label")||resource.get("name"))||""),found:!!this.props.resource};var resource}getResourceInfo(){return{resourceType:this.props.resourceType,collectionId:this.props.collectionId,resourceTypeLabel:this.props.resourceTypeLabel?this.props.resourceTypeLabel:this.props.resourceType,uri:this.props.uri,...this.getLabelInfo(),id:this.props.resourceId,redirectUrl:this.props.redirectUrl,onCancelRedirectUrl:this.props.onCancelRedirectUrl,resource:this.props.resource}}render(){const resourceInfo=this.getResourceInfo(),validateAction={componentId:this.props[constants.VALIDATE_ACTION],model:resourceInfo,label:this.props.t("DELETE_RESOURCE_YES",{defaultValue:"REMOVE"}),bsStyle:"danger",onClickActionCreator:"DeleteResource#validate",...this.props.validateActionProps},cancelAction={componentId:this.props[constants.CANCEL_ACTION],model:resourceInfo,label:this.props.t("DELETE_RESOURCE_NO",{defaultValue:"CANCEL"}),className:"btn-inverse",onClickActionCreator:"DeleteResource#cancel",...this.props.cancelAction};let question;const{resourceTypeLabel,label}=resourceInfo;return question=this.props.female?(0,jsx_runtime.jsxs)(es.x6,{i18nKey:"tui-containers:DELETE_RESOURCE_MESSAGE",tOptions:{context:"female"},children:["Are you sure you want to remove the ",{resourceTypeLabel}," ",(0,jsx_runtime.jsx)("strong",{children:{label}}),"?"]}):(0,jsx_runtime.jsxs)(es.x6,{i18nKey:"tui-containers:DELETE_RESOURCE_MESSAGE",children:["Are you sure you want to remove the ",{resourceTypeLabel}," ",(0,jsx_runtime.jsx)("strong",{children:{label}}),"?"]}),(0,jsx_runtime.jsx)(components_lib_esm.ConfirmDialog,{show:!0,header:this.props.header,cancelAction,validateAction,getComponent:this.props.getComponent,onHide:this.onHide,children:question})}}DeleteResource.displayName="DeleteResource",_defineProperty(DeleteResource,"displayName","Container(DeleteResource)"),_defineProperty(DeleteResource,"propTypes",{...lib_esm.TJ.propTypes,header:prop_types_default().string,uri:prop_types_default().string.isRequired,resourceType:prop_types_default().string.isRequired,resourceTypeLabel:prop_types_default().string,resourceId:prop_types_default().string,collectionId:prop_types_default().string,female:prop_types_default().bool,onCancelRedirectUrl:prop_types_default().string,validateActionProps:prop_types_default().object,t:prop_types_default().func}),_defineProperty(DeleteResource,"defaultProps",{validateActionProps:{},t:function getDefaultT(){return(0,es.TO)().t.bind((0,es.TO)())}()});const DeleteResource_container=(0,es.CI)("tui-containers")(DeleteResource);var lodash=__webpack_require__("../../node_modules/lodash/lodash.js");const DeleteResource_connect=(0,lib_esm.TJ)({defaultProps:{saga:"DeleteResource#handle"},mapStateToProps:function mapStateToProps(state,ownProps){const props={};let resourceId=ownProps.resourceId;if(ownProps.resourceId||(resourceId=(0,lodash.get)(ownProps,`params.${ownProps.routerParamAttribute||"id"}`),props.resourceId=resourceId),ownProps.resource)props.resource=ownProps.resource;else{const collectionId=ownProps.collectionId||ownProps.resourceType;collectionId&&(props.resource=state.cmf.collections.get(collectionId,new(immutable_default().Map)).find((currentResource=>currentResource.get("id")===resourceId)))}return props},omitCMFProps:!0,withComponentRegistry:!0,withDispatch:!0,withDispatchActionCreator:!0,withComponentId:!0})(DeleteResource_container);var redux_saga_effects_npm_proxy_esm=__webpack_require__("../../node_modules/redux-saga/dist/redux-saga-effects-npm-proxy.esm.js");function*redirect(url){if(!(0,lodash.isString)(url))throw new Error("redirect url can not be empty");yield(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.DIALOG_BOX_DELETE_RESOURCE_CLOSE,cmf:{routerReplace:url}})}function*deleteResourceValidate(uri,resourceType,itemId,resourcePath,collectionId,resourceUri){const action=yield(0,redux_saga_effects_npm_proxy_esm.s)(constants.DIALOG_BOX_DELETE_RESOURCE_OK),safeURI=(0,lodash.get)(action,"data.model.uri",uri),safeType=(0,lodash.get)(action,"data.model.resourceType",resourceType),safeId=(0,lodash.get)(action,"data.model.id",itemId),safePath=(0,lodash.get)(action,"data.model.resourcePath",resourcePath),resourceLocator=function getResourceLocator(resourceType,resourcePath){if(resourcePath){if(Array.isArray(resourcePath))return[resourceType,...resourcePath];throw Error(`Optional parameter resourcePath must be an array of string,\ngot ${resourcePath}`)}return resourceType}((0,lodash.get)(action,"data.model.collectionId",collectionId)||safeType,safePath);let resource;resource=(0,lodash.get)(action,"data.model.resource")?(0,lodash.get)(action,"data.model.resource"):yield(0,redux_saga_effects_npm_proxy_esm.Lt)(lib_esm.Ay.selectors.collections.findListItem,resourceLocator,safeId);const safeResourceUri=(0,lodash.get)(action,"data.model.resourceUri",resourceUri||`${safeURI}/${safeType}/${safeId}`);if(resource&&safeResourceUri){const result=yield(0,redux_saga_effects_npm_proxy_esm.T1)(lib_esm.Ay.sagas.http.delete,safeResourceUri);result.response.ok?(yield(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.DIALOG_BOX_DELETE_RESOURCE_SUCCESS,model:{...(0,lodash.get)(action,"data.model",{}),id:safeId,labelResource:resource.get("label")||resource.get("name","")}}),yield(0,redux_saga_effects_npm_proxy_esm.T1)(redirect,(0,lodash.get)(action,"data.model.redirectUrl"))):yield(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.DIALOG_BOX_DELETE_RESOURCE_ERROR,error:result.data})}}function*deleteResourceCancel(){const action=yield(0,redux_saga_effects_npm_proxy_esm.s)(constants.DIALOG_BOX_DELETE_RESOURCE_CANCEL),url=(0,lodash.get)(action,"data.model.onCancelRedirectUrl",(0,lodash.get)(action,"data.model.redirectUrl"));yield(0,redux_saga_effects_npm_proxy_esm.T1)(redirect,url)}function getDeleteResourceSagaRouter({uri,resourceType,redirectUrl,resourcePath,routerParamsAttribute="id",collectionId,resourceUri}={}){return console.warn(`DEPRECATED: please move the following sagaRouter config as props of DeleteResource container:\n\t{\n\t\turi: ${uri},\n\t\tresourceType: ${resourceType},\n\t\tredirectUrl: ${redirectUrl},\n\t\tresourcePath: ${resourcePath},\n\t}`),function*deleteResourceSaga(routerParams){try{yield(0,redux_saga_effects_npm_proxy_esm.O4)({deleteConfirmationValidate:(0,redux_saga_effects_npm_proxy_esm.T1)(deleteResourceValidate,uri,resourceType,routerParams[routerParamsAttribute],resourcePath,collectionId,resourceUri),deleteConfirmationCancel:(0,redux_saga_effects_npm_proxy_esm.T1)(deleteResourceCancel)})}catch(error){throw new Error(`DeleteResource failed :${error}`)}}}getDeleteResourceSagaRouter["DeleteResource#handle"]=function*handle(){try{yield(0,redux_saga_effects_npm_proxy_esm.O4)({deleteConfirmationValidate:(0,redux_saga_effects_npm_proxy_esm.T1)(deleteResourceValidate),deleteConfirmationCancel:(0,redux_saga_effects_npm_proxy_esm.T1)(deleteResourceCancel)})}catch(error){throw new Error(`DeleteResource failed: ${error}`)}};const sagas=getDeleteResourceSagaRouter;const actions={open:function actions_open(event,data){const{model}=data,pathname=window.location.pathname;return{type:constants.DIALOG_BOX_DELETE_RESOURCE,cmf:{routerReplace:`${pathname}/${model.id}/delete`},model,redirectUrl:pathname}},validate:function validate(event,data){return{type:constants.DIALOG_BOX_DELETE_RESOURCE_OK,data}},cancel:function cancel(event,data){return{type:constants.DIALOG_BOX_DELETE_RESOURCE_CANCEL,data}}};DeleteResource_connect.constants=constants,DeleteResource_connect.sagas=sagas,DeleteResource_connect.actions={"deleteResource:open":actions.open,"DeleteResource#validate":actions.validate,"DeleteResource#cancel":actions.cancel};const src_DeleteResource=DeleteResource_connect;const props={uri:"/myEndpoint",resourceType:"myResourceType",resourceTypeLabel:"resource",header:"My header title","cancel-action":"dialog:delete:cancel","validate-action":"dialog:delete:validate",routeParams:{id:"myID"},female:!0,params:{id:"myID"}},DeleteResource_stories={parameters:{storySource:{source:'import DeleteResource from \'.\';\n\n/*\nActions example\nThe components needs two actions, respectively \'cancel-action\' and \'validate-action\'.\nAlso require two fields, uri it contains the uri to call and resourceType, the type of resource.\n---------------------------------------\n"actions": {\n\t"my:validate:action": {\n\t\t"id": "my:validate:action",\n\t\t"label": "Yes",\n\t\t"bsStyle": "danger",\n\t\t"actionCreator": "deleteResource:validate"\n\t},\n\t"my:cancel:action": {\n\t\t"id": "my:cancel:action",\n\t\t"label": "No",\n\t\t"actionCreator": "deleteResource:cancel"\n\t}\n},\n"views": {\n\t"Container(DeleteResource)#resourceType": {\n\t\t"resourceInfo": { "uri": "/myEndpoint", "resourceType": "myResourceType" },\n\t\t"header": "My header title",\n\t\t"cancel-action": "my:cancel:action",\n\t\t"validate-action": "my:validate:action"\n\t}\n}\n*/\n\nconst views = {\n\turi: \'/myEndpoint\',\n\tresourceType: \'myResourceType\',\n\tresourceTypeLabel: \'resource\',\n\theader: \'My header title\',\n\t\'cancel-action\': \'dialog:delete:cancel\',\n\t\'validate-action\': \'dialog:delete:validate\',\n\trouteParams: { id: \'myID\' },\n\tfemale: true,\n};\n\nconst params = {\n\tid: \'myID\',\n};\n\nconst props = {\n\t...views,\n\tparams,\n};\n\nexport default {\n\ttitle: \'DeleteResource\',\n};\n\nexport function Default() {\n\treturn <DeleteResource {...props} />;\n}\n',locationsMap:{default:{startLoc:{col:7,line:55},endLoc:{col:1,line:57},startBody:{col:7,line:55},endBody:{col:1,line:57}}}}},title:"DeleteResource"},Default=function Default(){return(0,jsx_runtime.jsx)(src_DeleteResource,{...props})};Default.displayName="Default",Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"function Default() {\n  return <DeleteResource {...props} />;\n}",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]}}]);
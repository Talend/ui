import{u as rt}from"./useLocalStorage-DdbDKQl9.js";import{r as p,j as m,a as k,at as i,al as nt,I as it,au as V}from"./iframe-ChHbVRNu.js";import{D as lt,d as B,C as at,a as v,S as E,b as ct,c as ut}from"./SelectAll.component-D2vwKYjC.js";import"./ColumnChooser.component-iee8JSNx.js";import"./flow-DiV8LQaj.js";import{d as dt}from"./debounce-TEgH1C-D.js";import{g as w}from"./get-CwrUn-1j.js";import{i as mt}from"./isEqual-DvOxteNA.js";import{r as ft}from"./map-B6oy5sIh.js";import{B as pt}from"./ButtonIconFloating-7zhGmX5P.js";import{V as U}from"./index-BKy2R0Tr.js";import{a as gt}from"./translate-DSkg9kkf.js";import{I as bt}from"./constants-CZYEPhht.js";import{i as yt}from"./isNil-CEAzI_Md.js";import{w as Ct}from"./withTranslation-DNrQQHNO.js";import"./index-DGGBlbSp.js";import{g as $}from"./theme-6pUkCs8M.js";import{N as St}from"./NavItem-CNQ1sbMV.js";import{N as Y,a as _t}from"./NavDropdown-C5Twc_GW.js";import{M as ht}from"./SplitButton-DuNCG4_z.js";import{B as Tt}from"./RootCloseWrapper-CDbyJ8bQ.js";import{F as xt}from"./FilterBar.component-oMm1b7sA.js";const q=p.createContext();function _(){const t=p.useContext(q);if(!t)throw Error("@talend/react-components > List: you are using a sub component out of List.Manager.");return t}function I({children:t,displayModesOptions:e,id:o,onChange:s,selectedDisplayMode:r}){const{displayMode:l,setDisplayMode:a,t:n}=_(),d=(u,c)=>{s?s(u,c):a(c)};return t||m.jsx(lt,{id:o,mode:r||l,displayModes:e,onChange:d,t:n})}I.defaultProps={id:k(),displayModesOptions:B};I.propTypes={children:i.node,displayModesOptions:i.arrayOf(i.string),id:i.string,onChange:i.func,selectedDisplayMode:i.string};function L(t){const{columns:e,visibleColumns:o,setVisibleColumns:s}=_();return m.jsx(at,{columns:e.map(({dataKey:r,label:l},a)=>({key:r,label:l,hidden:!o?.includes(r),order:a+1})),...t,onSubmit:(r,l)=>{s(l.filter(a=>!a.hidden).map(a=>a.key)),t.onSubmit&&t.onSubmit(r,l)}})}L.propTypes={onSubmit:i.func};function z(t){const{id:e,totalItems:o,selected:s,label:r,labelSelected:l}=t,{t:a}=_();return m.jsx("div",{className:"tc-items-number",id:e,children:s?l||a("LIST_TOOLBAR_NUMBER_OF_SELECTED_ITEMS",{defaultValue:"{{count}}/{{total}} item",defaultValue_other:"{{count}}/{{total}} items",count:s,total:o}):r||a("LIST_TOOLBAR_TOTAL_NUMBER_OF_ITEMS",{defaultValue:"{{count}} item",defaultValue_other:"{{count}} items",count:o})})}z.propTypes={id:i.string,selected:i.number,totalItems:i.number,label:i.string,labelSelected:i.string};var Ot=ft();const R=nt(Ot),Lt="_list_1mxkj_2",Dt="_vlist_1mxkj_14",H={list:Lt,vlist:Dt},P=t=>Array.isArray(t)?t.filter(e=>!!e.props?.dataKey).map(e=>e.props):null;function x({children:t,columnChooser:e,...o}){const{displayMode:s=v.TABLE,collection:r,visibleColumns:l,setSortParams:a,sortParams:n,setColumns:d,columns:u,setVisibleColumns:c}=_();if(c&&!l){const f=P(t);c(R(f,"dataKey"))}p.useEffect(()=>{const f=P(t);f&&!mt(R(f,"dataKey"),R(u,"dataKey"))&&d(f)},[t,d]);const g=!!e&&s===v.TABLE&&m.jsx(L,{...e,buttonRenderer:pt});return m.jsx("div",{className:H.vlist,children:m.jsx(U,{collection:r,type:s.toUpperCase(),sortBy:w(n,"sortBy"),sortDirection:w(n,"isDescending")?E.DESC:E.ASC,sort:({sortBy:f,sortDirection:y})=>a({sortBy:f,isDescending:y===E.DESC}),headerAction:g,...o,children:l&&Array.isArray(t)?t.filter(f=>l.includes(f.props?.dataKey)):t})})}x.propTypes={children:i.arrayOf(i.node),columnChooser:i.oneOfType([i.bool,...Object.values(L.propTypes)])};Object.entries(U).forEach(([t,e])=>{x[t]=e});x.displayName="VList";const Et=5,Rt=20,Mt=0;function M(t){const{rowCount:e,threshold:o,minimumBatchSize:s,loadMoreRows:r,debounceDelay:l,onRowsRendered:a,...n}=t,{collection:d}=_(),u=({index:g})=>d&&d[g];let c=r;return c&&l&&(c=dt(c,l)),m.jsx(it,{isRowLoaded:u,loadMoreRows:c,minimumBatchSize:s,rowCount:e,threshold:o,children:({onRowsRendered:g,registerChild:f})=>{function y(...S){a&&a(...S),g(...S)}return m.jsx(x,{registerChild:f,onRowsRendered:y,rowCount:e,...n})}})}M.defaultProps={threshold:Et,minimumBatchSize:Rt,debounceDelay:Mt};function jt({sortBy:t,isDescending:e}){const o=e?-1:1;return function(r,l){return new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}).compare(r[t],l[t])*o}}function Bt(t,e,o){const{sortBy:s}=e;if(!s)return t;const r=o[s]||jt;return t.slice(0).sort(r(e))}const G=(t,e)=>o=>p.useMemo(()=>Bt(o,t,e),[o,t,e]);function J(t=[],e={},o={}){const[s,r]=p.useState(e);return{sortedCollection:G(s,o)(t),sortParams:s,setSortParams:r}}function W(t){return t.toString().toLocaleLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function It(t,e){return!yt(t)&&W(t).includes(e)}function Nt(t,e,o,s,r){if(!e)return t;const l=W(e);return t.filter(a=>Object.entries(a).filter(([n])=>s&&Array.isArray(s)?s.includes(n):r&&Array.isArray(r)?r.includes(n):!0).find(([n,d])=>o[n]?o[n](d,e):It(d,l)))}const Z=(t,e={},o,s)=>(r=[])=>p.useCallback(Nt(r,t,e,o,s),[r,t,e,o,s]),Q=(t=[],e,o={},s,r)=>{const[l,a]=p.useState(r),[n,d]=p.useState(e);return{filteredCollection:Z(n,o,s,l)(t),filteredColumns:l,textFilter:n,setFilteredColumns:a,setTextFilter:d}},Ft=(t,e,o)=>{if(e){const s=e.find(r=>r.dataKey===t);return s?s.visible:!0}else if(o.length)return o.includes(t);return!0};function At(t=[],e=[],o){const[s,r]=p.useState(()=>{let n;if(o){const d=localStorage.getItem(o);try{n=d&&JSON.parse(d)}catch{}}return n}),l=p.useMemo(()=>s?.filter(({visible:n})=>!!n).map(({dataKey:n})=>n),[s]),a=(n,d)=>{if(n.length){const u=n.map(({dataKey:c})=>({dataKey:c,visible:d.includes(c)}));o&&localStorage.setItem(o,JSON.stringify(u)),r(u)}};return p.useEffect(()=>{a(t,t.filter(({dataKey:n})=>Ft(n,s,e)).map(({dataKey:n})=>n))},[t]),{visibleColumns:l,setVisibleColumns:n=>a(t,n)}}function N({initialDisplayMode:t,initialSortParams:e,initialVisibleColumns:o,columnsVisibilityStorageKey:s,children:r,t:l,...a}){let n=a.collection;const[d,u]=p.useState(t||B[0]),[c,g]=p.useState([]),{visibleColumns:f,setVisibleColumns:y}=At(c,o,s),{sortedCollection:S,sortParams:O,setSortParams:b}=J(n,e);n=S;const{filteredCollection:C,textFilter:h,setTextFilter:A,filteredColumns:D,setFilteredColumns:ot}=Q(n,void 0,void 0,f);n=C;const st={collection:n,displayMode:d,columns:c,visibleColumns:f,filteredColumns:D,setDisplayMode:u,setSortParams:b,setTextFilter:A,setColumns:g,setVisibleColumns:y,setFilteredColumns:ot,sortParams:O,t:l,textFilter:h};return m.jsx(q.Provider,{value:st,children:m.jsx("div",{className:H.list,children:r})})}N.defaultProps={t:gt()};N.propTypes={children:i.node,collection:i.array,id:i.string.isRequired,initialDisplayMode:i.oneOf(B),initialVisibleColumns:i.arrayOf(i.string),initialSortParams:i.shape({sortBy:i.string,isDescending:i.bool}),columnsVisibilityStorageKey:i.string,t:i.func};const Vt=Ct(bt)(N),vt={"tc-sort-by":"_tc-sort-by_1tgwf_2","tc-sort-by-label":"_tc-sort-by-label_1tgwf_9","tc-sort-by-order-chooser":"_tc-sort-by-order-chooser_1tgwf_19","tc-sort-by-items":"_tc-sort-by-items_1tgwf_38"},T=$(vt),X=({id:t,isDescending:e,orderLabel:o,t:s,onClick:r})=>m.jsxs(Tt,{"aria-label":s("LIST_CHANGE_SORT_BY_ORDER",{defaultValue:"Change sort order. Current order: {{sortOrder}}.",sortOrder:o}),bsStyle:"link",className:T("tc-sort-by-order-chooser"),id:`${t}-order-chooser`,onClick:r,children:[m.jsx(V,{name:e?"talend-sort-desc":"talend-sort-asc"}),m.jsx(V,{className:T("tc-sort-by-order-chooser-indicator"),name:"talend-caret-down",transform:e?null:"rotate-180"})]});X.propTypes={id:i.string.isRequired,isDescending:i.bool,onClick:i.func.isRequired,orderLabel:i.string.isRequired,t:i.func.isRequired};function K({id:t,options:e,onChange:o,value:s}){const{sortParams:r,setSortParams:l,t:a}=_(),n=o&&s,d=n?s:r,u=d.isDescending,c=e.find(b=>b.key===d.sortBy),g=c?c.label:"N.C",f=u?a("LIST_SELECT_SORT_BY_ORDER_DESC",{defaultValue:"Descending"}):a("LIST_SELECT_SORT_BY_ORDER_ASC",{defaultValue:"Ascending"}),y=(b,C)=>{n?o(b,C):l(C)},S=(b,C)=>{y(C,{...d,sortBy:b})},O=b=>y(b,{...d,isDescending:!u});return m.jsxs(St,{className:T("tc-sort-by"),children:[m.jsx("li",{children:m.jsx(Y.Text,{children:m.jsx("label",{className:T("tc-sort-by-label"),htmlFor:t,children:a("LIST_TOOLBAR_SORT_BY",{defaultValue:"Sort by:"})})})}),e.length===1?m.jsx("li",{className:"navbar-text",children:e[0].name}):m.jsx(_t,{"aria-label":a("LIST_CHANGE_SORT_BY",{defaultValue:"Change sort criteria. Current sort criteria: {{sortBy}}.",sortBy:g}),className:T("tc-sort-by-items"),id:`${t}-by`,onSelect:S,title:g,children:e.map(({key:b,label:C},h)=>m.jsx(ht,{"aria-label":a("LIST_SELECT_SORT_BY",{defaultValue:"Select {{sortBy}} as current sort criteria.",sortBy:C}),eventKey:b,id:`${t}-${b}`,children:C},`${b}-${h}`))}),c&&m.jsx("li",{children:m.jsx(X,{id:t,isDescending:u,onClick:O,orderLabel:f,t:a})})]})}K.defaultProps={id:k(),value:{}};function tt(t){const{docked:e,applyOn:o,initialDocked:s,onChange:r,onToggle:l,value:a,...n}=t,{textFilter:d,setTextFilter:u,setFilteredColumns:c}=_(),[g,f]=p.useState(s);p.useEffect(()=>{c(o)},[o,c]);const y=l,S=r,h={debounceTimeout:300,value:S?a:d,onFilter:S?r:(A,D)=>u(D),docked:y?e:g,onToggle:y?l:()=>{(g||!d)&&f(!g)}};return m.jsx(xt,{...h,...n})}tt.defaultProps={initialDocked:!0};const wt={"tc-list-toolbar":"_tc-list-toolbar_hg12j_2","tc-list-toolbar-right":"_tc-list-toolbar-right_hg12j_21","tc-list-toolbar-separated":"_tc-list-toolbar-separated_hg12j_28"},j=$(wt),et=({children:t})=>m.jsx("ul",{className:j("tc-list-toolbar-right"),children:p.Children.map(t,e=>e&&m.jsx("li",{className:j("tc-list-toolbar-separated"),children:e}))});et.propTypes={children:i.oneOfType([i.arrayOf(i.node),i.node])};function F(t){return m.jsx(Y,{componentClass:"div",className:j("tc-list-toolbar"),role:"toolbar",fluid:!0,children:t.children})}F.propTypes={children:i.node};F.Right=et;function Pt(t=[],e=[],o="id"){const[s,r]=p.useState(e),l=p.useCallback(u=>t.filter(c=>c&&u.includes(c[o])).map(c=>c[o]),[o,t]);p.useEffect(()=>{r(u=>u.length===0?u:l(u))},[t,l]);function a(u){if(!u)return!1;const c=u[o];return s.some(g=>g===c)}function n(u){const c=u[o],g=s.indexOf(c),f=s.slice(0);g>-1?f.splice(g,1):f.push(c),r(l(f))}function d(){t.length===s.length?r([]):r(t.filter(u=>!!u).map(u=>u[o]))}return{isSelected:a,allIsSelected:s.length>0&&s.length===t.length,selectedIds:s,onToggleAll:d,onToggleItem:n,setSelectedIds:r}}function kt(t=[],e=[],o=[]){return p.useMemo(()=>t.map(s=>({...s,actions:typeof e=="function"?e(s):e,persistentActions:typeof o=="function"?o(s):o})),[t,e,o])}const ce={constants:ut,ColumnChooser:L,DisplayMode:I,ItemsNumber:z,LazyLoadingList:M,InfiniteScrollList:M,Manager:Vt,SelectAll:ct,SortBy:K,TextFilter:tt,Toolbar:F,VList:x},ue={useCollectionActions:kt,useCollectionSort:J,sortCollection:G,useCollectionFilter:Q,useCollectionSelection:Pt,filterCollection:Z,useDisplayMode:rt};export{ce as L,ue as h};

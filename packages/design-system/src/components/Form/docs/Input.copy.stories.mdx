import { Canvas, Meta, Story } from '@storybook/addon-docs';
import { useForm } from 'react-hook-form';
import { FigmaImage, WithSelector } from '~docs';
import { ButtonPrimary, ButtonTertiary } from '../../Button';
import Form from '../';
import { InlineMessageInformation } from '../../InlineMessage';

<Meta
	title="Components/Form/Fields/Copy"
	parameters={{
		status: { figma: 'ok', storybook: 'ok', react: 'ok', i18n: 'ok' },
	}}
/>

# Copy

It's used to let the user copy a generated text to clipboard.

## Zoning

<FigmaImage
	src="https://www.figma.com/file/qc8oUSyVJM67gSsbTShftt/%F0%9F%93%90-Zoning?node-id=548%3A11"
	alt="zoning image for copy input"
/>

## Style

## States

### Default

<Canvas>
	<Story name="default">
		<Form.Copy name="copy" label="Copy" value="23e4567-e89b-12d3-a456-426614174000" />
	</Story>
</Canvas>

### Prefix

<Canvas>
	<Story name="With prefix">
		<Form.Copy
			name="copy"
			label="Copy"
			prefix={{ type: 'text', children: 'URL' }}
			value="https://exemple.com"
		/>
	</Story>
</Canvas>

### Hover

<Canvas withSource="none">
	<Story
		name="hover"
		decorators={[storyFn => <WithSelector selector=":hover">{storyFn()}</WithSelector>]}
	>
		<Form.Copy name="copy" label="Copy" value="23e4567-e89b-12d3-a456-426614174000" />
	</Story>
</Canvas>

### Focus

<Canvas withSource="none">
	<Story
		name="focus"
		decorators={[storyFn => <WithSelector selector=":focus">{storyFn()}</WithSelector>]}
	>
		<Form.Copy name="copy" label="Copy" value="23e4567-e89b-12d3-a456-426614174000" />
	</Story>
</Canvas>

### Empty

<Canvas>
	<Story name="empty">
		<Form.Copy name="copy" label="Copy" />
	</Story>
</Canvas>

### Disabled

<Canvas>
	<Story name="disabled">
		<Form.Copy name="copy" label="Copy" value="23e4567-e89b-12d3-a456-426614174000" disabled />
	</Story>
</Canvas>

### Read only

<Canvas>
	<Story name="read-only">
		<Form.Copy name="copy" label="Copy" value="23e4567-e89b-12d3-a456-426614174000" readOnly />
	</Story>
</Canvas>

## Interactions

## Usage with react-hook-form

When using Rhf, if you want the confirmation message to disappear in case of input change, you must use `watch` on the value or defaultValue.

<Canvas>
	<Story name="react-hook-form">
		{() => {
			const getUUID = () =>
				([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>
					(c ^ (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))).toString(16),
				);
			const { register, handleSubmit, setValue, watch } = useForm();
			const [formData, setFormData] = React.useState();
			return (
				<Form onSubmit={handleSubmit(setFormData)}>
					{formData && (
						<InlineMessageInformation
							title={'Form data'}
							description={JSON.stringify(formData, null, 2)}
							withBackground
						/>
					)}
					<Form.Row>
						<Form.Copy
							hideLabel
							label={'Key'}
							defaultValue="10ca0868-1010-4b4a-a2cc-ff737527a7b5"
							description={'This information is displayed only once.'}
							{...register('apiKey')}
						/>
						<ButtonTertiary icon="talend-refresh" onClick={() => setValue('apiKey', getUUID())}>
							Regenerate
						</ButtonTertiary>
					</Form.Row>
					<Form.Buttons>
						<ButtonPrimary type="submit" onClick={() => {}}>
							Submit
						</ButtonPrimary>
					</Form.Buttons>
				</Form>
			);
		}}
	</Story>
</Canvas>

## Accessibility

N/C

import{L as f,M as N,N as w,O as x,r as $,P as i,e as T,j as d,K as j,T as I,x as n,I as M,Q as y,m as E,k as g,B as V,f as A,p as D,S as K}from"./iframe-C463fdU7.js";import"./preload-helper-PPVm8Dsz.js";function k(){return f().t.bind(f())}f()||(console.warn("@talend/react-containers used without i18n host."),N(w.createInstance({},()=>{})));const H="tui-containers",P="DIALOG_BOX_DELETE_RESOURCE",q="DIALOG_BOX_DELETE_RESOURCE_OK",F="DIALOG_BOX_DELETE_RESOURCE_CANCEL",Q="DIALOG_BOX_DELETE_RESOURCE_SUCCESS",W="DIALOG_BOX_DELETE_RESOURCE_ERROR",Y="DIALOG_BOX_DELETE_RESOURCE_CLOSE",z="validate-action",J="cancel-action",a={DIALOG_BOX_DELETE_RESOURCE:P,DIALOG_BOX_DELETE_RESOURCE_OK:q,DIALOG_BOX_DELETE_RESOURCE_CANCEL:F,DIALOG_BOX_DELETE_RESOURCE_SUCCESS:Q,DIALOG_BOX_DELETE_RESOURCE_ERROR:W,DIALOG_BOX_DELETE_RESOURCE_CLOSE:Y,VALIDATE_ACTION:z,CANCEL_ACTION:J};function Z(t){return t&&(t.get("label")||t.get("name"))||""}let ee=class extends $.Component{static displayName="Container(DeleteResource)";static propTypes={...T.propTypes,header:i.string,uri:i.string.isRequired,resourceType:i.string.isRequired,resourceTypeLabel:i.string,resourceId:i.string,collectionId:i.string,female:i.bool,onCancelRedirectUrl:i.string,validateActionProps:i.object,t:i.func};static defaultProps={validateActionProps:{},t:k()};constructor(e){super(e),this.getLabelInfo=this.getLabelInfo.bind(this),this.getResourceInfo=this.getResourceInfo.bind(this),this.onHide=this.onHide.bind(this)}onHide(e){this.props.dispatchActionCreator("DeleteResource#cancel",e,{model:this.getResourceInfo()})}getLabelInfo(){return{label:Z(this.props.resource),found:!!this.props.resource}}getResourceInfo(){return{resourceType:this.props.resourceType,collectionId:this.props.collectionId,resourceTypeLabel:this.props.resourceTypeLabel?this.props.resourceTypeLabel:this.props.resourceType,uri:this.props.uri,...this.getLabelInfo(),id:this.props.resourceId,redirectUrl:this.props.redirectUrl,onCancelRedirectUrl:this.props.onCancelRedirectUrl,resource:this.props.resource}}render(){const e=this.getResourceInfo(),o={componentId:this.props[a.VALIDATE_ACTION],model:e,label:this.props.t("DELETE_RESOURCE_YES",{defaultValue:"REMOVE"}),bsStyle:"danger",onClickActionCreator:"DeleteResource#validate",...this.props.validateActionProps},s={componentId:this.props[a.CANCEL_ACTION],model:e,label:this.props.t("DELETE_RESOURCE_NO",{defaultValue:"CANCEL"}),className:"btn-inverse",onClickActionCreator:"DeleteResource#cancel",...this.props.cancelAction};let c;const{resourceTypeLabel:l,label:r}=e;return this.props.female?c=d.jsxs(I,{i18nKey:"tui-containers:DELETE_RESOURCE_MESSAGE",tOptions:{context:"female"},children:["Are you sure you want to remove the ",{resourceTypeLabel:l}," ",d.jsx("strong",{children:{label:r}}),"?"]}):c=d.jsxs(I,{i18nKey:"tui-containers:DELETE_RESOURCE_MESSAGE",children:["Are you sure you want to remove the ",{resourceTypeLabel:l}," ",d.jsx("strong",{children:{label:r}}),"?"]}),d.jsx(j,{show:!0,header:this.props.header,cancelAction:s,validateAction:o,getComponent:this.props.getComponent,onHide:this.onHide,children:c})}};const te=x(H)(ee);function re(t,e){const o={};let s=e.resourceId;if(e.resourceId||(s=n(e,`params.${e.routerParamAttribute||"id"}`),o.resourceId=s),e.resource)o.resource=e.resource;else{const c=e.collectionId||e.resourceType;c&&(o.resource=t.cmf.collections.get(c,new M.Map).find(l=>l.get("id")===s))}return o}const O=T({defaultProps:{saga:"DeleteResource#handle"},mapStateToProps:re,omitCMFProps:!0,withComponentRegistry:!0,withDispatch:!0,withDispatchActionCreator:!0,withComponentId:!0})(te);function oe(t,e){if(e){if(Array.isArray(e))return[t,...e];throw Error(`Optional parameter resourcePath must be an array of string,
got ${e}`)}return t}function*S(t){if(!K(t))throw new Error("redirect url can not be empty");yield D({type:a.DIALOG_BOX_DELETE_RESOURCE_CLOSE,cmf:{routerReplace:t}})}function*U(t,e,o,s,c,l){const r=yield g(a.DIALOG_BOX_DELETE_RESOURCE_OK),m=n(r,"data.model.uri",t),R=n(r,"data.model.resourceType",e),u=n(r,"data.model.id",o),B=n(r,"data.model.resourcePath",s),X=n(r,"data.model.collectionId",c),v=oe(X||R,B);let p;n(r,"data.model.resource")?p=n(r,"data.model.resource"):p=yield V(A.selectors.collections.findListItem,v,u);const h=n(r,"data.model.resourceUri",l||`${m}/${R}/${u}`);if(p&&h){const L=yield E(A.sagas.http.delete,h);L.response.ok?(yield D({type:a.DIALOG_BOX_DELETE_RESOURCE_SUCCESS,model:{...n(r,"data.model",{}),id:u,labelResource:p.get("label")||p.get("name","")}}),yield E(S,n(r,"data.model.redirectUrl"))):yield D({type:a.DIALOG_BOX_DELETE_RESOURCE_ERROR,error:L.data})}}function*b(){const t=yield g(a.DIALOG_BOX_DELETE_RESOURCE_CANCEL),e=n(t,"data.model.onCancelRedirectUrl",n(t,"data.model.redirectUrl"));yield E(S,e)}function G({uri:t,resourceType:e,redirectUrl:o,resourcePath:s,routerParamsAttribute:c="id",collectionId:l,resourceUri:r}={}){return console.warn(`DEPRECATED: please move the following sagaRouter config as props of DeleteResource container:
	{
		uri: ${t},
		resourceType: ${e},
		redirectUrl: ${o},
		resourcePath: ${s},
	}`),function*(R){try{yield y({deleteConfirmationValidate:E(U,t,e,R[c],s,l,r),deleteConfirmationCancel:E(b)})}catch(u){throw new Error(`DeleteResource failed :${u}`)}}}function*se(){try{yield y({deleteConfirmationValidate:E(U),deleteConfirmationCancel:E(b)})}catch(t){throw new Error(`DeleteResource failed: ${t}`)}}G["DeleteResource#handle"]=se;function ne(t,e){const{model:o}=e,s=window.location.pathname;return{type:a.DIALOG_BOX_DELETE_RESOURCE,cmf:{routerReplace:`${s}/${o.id}/delete`},model:o,redirectUrl:s}}function ae(t,e){return{type:a.DIALOG_BOX_DELETE_RESOURCE_OK,data:e}}function ce(t,e){return{type:a.DIALOG_BOX_DELETE_RESOURCE_CANCEL,data:e}}const C={open:ne,validate:ae,cancel:ce};O.constants=a;O.sagas=G;O.actions={"deleteResource:open":C.open,"DeleteResource#validate":C.validate,"DeleteResource#cancel":C.cancel};const ie={uri:"/myEndpoint",resourceType:"myResourceType",resourceTypeLabel:"resource",header:"My header title","cancel-action":"dialog:delete:cancel","validate-action":"dialog:delete:validate",routeParams:{id:"myID"},female:!0},le={id:"myID"},Ee={...ie,params:le},Re={title:"DeleteResource"};function _(){return d.jsx(O,{...Ee})}_.parameters={..._.parameters,docs:{..._.parameters?.docs,source:{originalSource:`function Default() {
  return <DeleteResource {...props} />;
}`,..._.parameters?.docs?.source}}};const _e=["Default"];export{_ as Default,_e as __namedExportsOrder,Re as default};

import{j as a,V as I,a4 as M,P as n,u as _,I as C,r as N,e as S,b as h}from"./iframe-C463fdU7.js";import{o as R}from"./omit-DN314HDN.js";import{A as y}from"./Action.connect-1ulOHfpS.js";import{F,D as k,Q as v}from"./index-hHr8tPlF.js";import{L as $}from"./index-n2nI19EW.js";import{T as P,D as B}from"./TreeView.container-C1EMtODp.js";import"./preload-helper-PPVm8Dsz.js";import"./actionAPI-VfXDUlCa.js";const W="_wrapper_us5bl_1",Y="_filter_us5bl_8",J="_container_us5bl_11",z="_list_us5bl_16",Q="_tree_us5bl_19",U="_results_us5bl_23",V="_preview_us5bl_40",p={wrapper:W,filter:Y,container:J,list:z,tree:Q,results:U,preview:V};function j({filteredData:r,idAttr:t,nameAttr:e,results:o,sourceData:s,tree:i,filter:l={},...c}){let d;return c.schema&&c.selected&&(d={properties:c.selected,...c.schema}),a.jsxs("div",{className:`tc-select-object ${p.wrapper}`,children:[a.jsx(F,{...l,className:I(l.className,p.filter),id:c.id,dockable:!1,navbar:!1}),a.jsxs("div",{className:p.container,children:[!i&&!r&&a.jsx($,{...c.list,id:`${c.id}-list`,data:s,className:p.list}),i&&!r&&a.jsx(P,{...i,componentId:c.id,noHeader:!0,data:s,className:p.tree}),r&&a.jsx("div",{className:p.results,children:r.map(u=>a.jsxs(y,{className:I({active:o.selectedId===u.get(t)}),onClick:m=>o.onClick(m,u),children:[a.jsx("h3",{children:u.get(e)}),a.jsx("span",{children:u.get("currentPosition")})]},u.get(t)))}),d&&a.jsx(M,{schema:d,className:p.preview})]})]})}j.displayName="SelectObject";j.propTypes={id:n.string,idAttr:n.string,nameAttr:n.string,tree:n.object,list:n.object,filter:n.object,schema:n.object,filteredData:_.List,results:n.shape({selectedId:n.string,onClick:n.func}),sourceData:_.List,selected:n.object};j.defaultProps={idAttr:"id"};const H="Container(SelectObject)",T=new C.Map({});function O(){}function w(r,t,{idAttr:e="id"}={}){let o;return r.forEach(s=>{s.get(e)===t?o=s.toJS():!o&&s.get("children",new h.List).size>0&&(o=w(s.get("children"),t,{idAttr:e}))}),o}function q(r){return r.get("children",new h.List).size===0}function G(r,t,e,o,s,i){if(r.get(o,"").toLowerCase().includes(e.toLowerCase())){const c=r.set("currentPosition",t);return s(r),i.push(c)}return i}function x(r=new h.List,t="",{nameAttr:e="name",onMatch:o=O}={},s="root"){return t?r.reduce((i,l)=>{if(q(l))return G(l,s,t,e,o,i);const c=l.get(e,""),d=x(l.get("children"),t,{nameAttr:e},`${s} > ${c}`);return i.concat(d)},new h.List):r}function D(r=new h.List,t="",{nameAttr:e="name",onMatch:o=O}={},s="root"){const i=new h.List;return t?r.reduce((l,c)=>{const d=c.get(e,""),u=c.get("children",null);let m=l;return d.toLowerCase().includes(t.toLowerCase())&&(o(c),m=l.push(c.set("currentPosition",s))),u&&(m=m.concat(D(u,t,{nameAttr:e},`${s} > ${d}`))),m},i):i}let K=class g extends N.Component{static displayName=H;static FILTER_MODE={ALL:"ALL",LEAF:"LEAF"};static propTypes={...S.propTypes,selectedId:n.string,tree:n.object,idAttr:n.string,nameAttr:n.string,breadCrumbsRootLabel:n.string,filterMode:n.oneOf([g.FILTER_MODE.ALL,g.FILTER_MODE.LEAF])};static defaultProps={sourceData:new C.List,idAttr:"id",nameAttr:"name",breadCrumbsRootLabel:"root"};constructor(t){super(t),this.state={},this.filter=x,this.filterAll=D,this.getById=w,this.onTreeClick=this.onTreeClick.bind(this),this.onResultsClick=this.onResultsClick.bind(this)}onTreeClick(t){this.props.setState({selectedId:t[this.props.idAttr]})}onResultsClick(t,e){this.props.setState({selectedId:e.get(this.props.idAttr)})}render(){const t=this.props.state||T,e=R(this.props,S.INJECTED_PROPS),o=this.props.filterMode===g.FILTER_MODE.ALL?this.filterAll:this.filter,s=[];let i=t.get("selectedId")||e.selectedId;function l(c){s.push(c)}return e.query&&(e.filteredData=o(e.sourceData,e.query,{...e,onMatch:l},e.breadCrumbsRootLabel),delete e.tree,!i&&s.length===1&&(i=s[0].get("id")),e.results={onClick:this.onResultsClick,idAttr:this.props.idAttr,nameAttr:this.props.nameAttr,selectedId:i}),i&&(e.selected=this.getById(e.sourceData,i,e)),e.tree&&(e.tree.selectedId=i,e.tree.onSelect=this.onTreeClick),a.jsx(j,{...e})}};function X(r,t){const e={};t.source&&(e.sourceData=r.cmf.collections.getIn(t.source.split("."))),t.nameAttr&&t.tree&&(e.tree={nameAttr:t.nameAttr,...t.tree});const o=r.cmf.components.getIn([k,t.id]);o?e.query=o.get(v,""):e.query="";const s=r.cmf.components.getIn([B,t.id]);return s&&(e.selectedId=s.get("selectedId")),e}const A=S({mapStateToProps:X,defaultState:T,omitCMFProps:!0,withComponentRegistry:!0,withDispatch:!0,withDispatchActionCreator:!0,withComponentId:!0})(K),E={id:"example",source:"with.data",nameAttr:"label",tree:{}},Z={jsonSchema:{title:"Demo",type:"object",properties:{label:{type:"string",title:"Label"},id:{type:"integer",title:"ID"},author:{type:"string",title:"Author"},created:{type:"string",title:"Created"}}},uiSchema:{"ui:order":["label","id","author","created"]}},ae={title:"SelectObject"},f=()=>a.jsx(A,{...E}),L=()=>a.jsx(A,{...E,schema:Z}),b=()=>a.jsx(A,{...E,filterMode:A.FILTER_MODE.ALL});f.parameters={...f.parameters,docs:{...f.parameters?.docs,source:{originalSource:"() => <SelectObject {...props} />",...f.parameters?.docs?.source}}};L.parameters={...L.parameters,docs:{...L.parameters?.docs,source:{originalSource:"() => <SelectObject {...props} schema={schema} />",...L.parameters?.docs?.source}}};b.parameters={...b.parameters,docs:{...b.parameters?.docs,source:{originalSource:"() => <SelectObject {...props} filterMode={SelectObject.FILTER_MODE.ALL} />",...b.parameters?.docs?.source}}};const le=["Default","WithPreview","WithFilterModeSetToALL"];export{f as Default,b as WithFilterModeSetToALL,L as WithPreview,le as __namedExportsOrder,ae as default};

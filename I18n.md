# I18n

UI uses [react-i18n](https://react.i18next.com/) to make the components internationalizable. This is based on [i18next](https://www.i18next.com/)

The application defines the strategy how to get the translations.

### Namespaces

Each packages has their own namespace:

| Package        | Namespace     |
| ------------- 	|:-------------:|
| components      | tui-components |
| forms      			| tui-forms      |

### Creating a i18n components

Each components who has to be internationalizable are exported by default with translate from 'react-i18next' with his namespace.

**The component can be to use with or without a internationalizable application. For this, in the creation of the component, we pass it a default i18n. Translate will check if a i18n context exists and uses it else it uses the default i18n.**

```javascript
import React from 'react';
import i18n from 'i18next';
import { translate } from 'react-i18next';

import { I18N_DOMAIN } from '../constants';
import defaultTranslateFn from '../translate';

const HelloWorld = ({t}) => (
 <div>{`Hi ${t('HELLO', { defaultValue: 'Hello world' })}`}</div>
);

// To avoid to pass t in the test, create a default t props
HelloWorld.defaultProps = {
  t: defaultTranslateFn,
}

// Export component to test it with a fake t method
export { HelloWorld };
export default translate(I18N_DOMAIN, { i18n })(HelloWorld);
```

### Translate

In the framework, at each time that the `t` method is called, a defaultValue is given to test it.

```javascript
t('SUFFIX_COMPONENT_KEY', { defaultValue: 'translated'});
```

The key has to be prefixed by the main current component to translate.
e.g:
 LIST_DISPLAY
 HEADERBAR_GO_PORTAL

## Use i18n with UI in your App

### Create an instance of i18n
`yarn add i18next`

```javascript
import i18n from 'i18next';

i18n.init({
	debug: false,
	wait: true, // globally set to wait for loaded translations in translate hoc
});

export default i18n;
```

The UI framework have to be nested into a Provider to allow to translate the labels. The provider is responsible to pass the i18next instance down to all the translate hocs using react context.

### Use the HOC TranslateWrapper

```javascript
import { TranslateWrapper } from 'react-talend-component';
import i18n from ...

import MyComponentToTranslate from ...

const MyComponentTranslated = TranslateWrapper(MyComponentToTranslate, { i18n });

<MyComponentTranslated />
```

### React Provider

```javascript
import { I18nextProvider } from 'i18next';
import i18n from ...


<I18nextProvider i18n={i18n}>
	<UI_COMPONENTS />
</I18nextProvider>
```

### Angular Provider with ng-react

Each components 'ng-react' 'll load his provider with a i18n given by the props. The components creates his react Provider with the i18n given.

```javascript
import React from ‘react’;
import translate from { react-i18next };
import i18n from ...;

const HelloWorld = ({t}) => (
 <div>{`${t('HELLO', { defaultValue: 'Hello world' })}`}</div>
 or
 <UI_COMPONENTS />
);
const TranslatedHelloWorld = translate()(HelloWorld);

const AppComponent = ({i18n}) => {
	<I18nextProvider i18n={i18n}>
		<TranslatedHelloWorld></TranslatedHelloWorld>
	</I18nextProvider>
}

angular.module('app', ['react'])
	.value('AppComponent', AppComponent);
  	.controller('appController', () => {
    		this.props = {
			i18n,
		}:
  	});

<react-component name="AppComponent" props="$ctrl.props"></react-component>
```

## Extract a catalog of the key in the framework

yarn extract-i18n
